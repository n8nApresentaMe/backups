{"createdAt":"2025-09-22T19:32:48.292Z","updatedAt":"2025-11-03T14:37:42.000Z","id":"YxaBUSS3T4m872sV","name":"üìä An√°lise de perfomance de campanha","active":true,"isArchived":false,"nodes":[{"parameters":{"jsCode":"return {\n  campaigns: $input.first().json.data.map(d => d.campaign_id)\n}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-864,80],"id":"13f2026d-d5d4-4065-8c70-de39f8e3599b","name":"Pega os ids das campanhas com insights"},{"parameters":{"jsCode":"const campaigns = $('Busca campanhas').first().json.data\nconst insights = $('Busca insights').first().json.data\n\nfor(const campaign of campaigns) {\n  const campaignInsights = insights.find(i => String(i.campaign_id) === String(campaign.id)) \n  campaignInsights.generated_leads = campaignInsights.actions.find(a => a.action_type == 'lead')?.value || 0\n\n  campaign.insights = campaignInsights\n}\n\nreturn {\n  campaigns\n}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-432,80],"id":"6d5b4e67-1f55-457f-992a-a7a0f88e024b","name":"Junta as informa√ß√µes de campanha com insights"},{"parameters":{"graphApiVersion":"v20.0","node":"act_1000490853790213","edge":"insights","options":{"queryParametersJson":"={ \"fields\": \"account_id,campaign_id,impressions,spend,clicks,ctr,cpc,cpm,reach,frequency,actions,cost_per_action_type,created_time,date_start,date_stop\", \"date_preset\": \"{{ $json.date_preset }}\", \"level\": \"campaign\", \"time_increment\": \"1\" }"}},"type":"n8n-nodes-base.facebookGraphApi","typeVersion":1,"position":[-1072,80],"id":"44bc0858-967f-4fee-8339-77e0e561a4fd","name":"Busca insights","credentials":{"facebookGraphApi":{"id":"Ex5QxAzJUnZDVBU4","name":"Facebook Graph account"}}},{"parameters":{"graphApiVersion":"v20.0","node":"act_1000490853790213","edge":"campaigns","options":{"queryParametersJson":"={\n  \"filtering\":\n  [\n      {\n          \"field\":\"id\",\n          \"operator\":\"IN\",\n          \"value\":[\"{{ $json.campaigns.join('\", \"') }}\"]\n      }\n  ],\n  \"fields\":\"id,name,status,objective\"\n} "}},"type":"n8n-nodes-base.facebookGraphApi","typeVersion":1,"position":[-656,80],"id":"93a694e3-4bc7-4d74-8fd9-766258efb163","name":"Busca campanhas","credentials":{"facebookGraphApi":{"id":"Ex5QxAzJUnZDVBU4","name":"Facebook Graph account"}}},{"parameters":{"model":{"__rl":true,"mode":"list","value":"claude-sonnet-4-20250514","cachedResultName":"Claude 4 Sonnet"},"options":{"maxTokensToSample":10000}},"type":"@n8n/n8n-nodes-langchain.lmChatAnthropic","typeVersion":1.3,"position":[240,320],"id":"c35e3b87-2dfc-470a-9ff2-d7e1db351586","name":"Anthropic Chat Model2","credentials":{"anthropicApi":{"id":"lyfyzPeMl3RhkeP5","name":"Anthropic account"}}},{"parameters":{"model":{"__rl":true,"mode":"list","value":"claude-sonnet-4-20250514","cachedResultName":"Claude 4 Sonnet"},"options":{"maxTokensToSample":20000}},"type":"@n8n/n8n-nodes-langchain.lmChatAnthropic","typeVersion":1.3,"position":[816,320],"id":"b63047dc-5604-46e5-8014-503921882095","name":"Anthropic Chat Model3","credentials":{"anthropicApi":{"id":"lyfyzPeMl3RhkeP5","name":"Anthropic account"}}},{"parameters":{"promptType":"define","text":"=Voc√™ √© um especialista em Meta Ads com 10 anos de experi√™ncia.\nSempre que receber dados brutos de campanhas atrav√©s do JSON:\n\nrealize diretamente a an√°lise e retorne o relat√≥rio completo.\n{{ JSON.stringify($('Junta as informa√ß√µes de campanha com insights').first().json.campaigns) }}\n\nATEN√á√ÉO: ESTA AN√ÅLISE REFERE-SE A CAMPANHAS NO PER√çODO {{ $('Formata data').first().json.period_type_translated.toUpperCase() }}\n------------------------------------------------------------\n1. C√°lculos obrigat√≥rios\n------------------------------------------------------------\n- CTR_link = cliques_link / imp (0 se imp=0)\n- CPC_link = gasto / cliques_link (‚àû/‚Äú‚Äî‚Äù se cliques_link=0)\n- Click‚ÜíLead = leads / cliques_link (0 se cliques_link=0)\n- CPL = gasto / leads (‚àû/‚Äú‚Äî‚Äù se leads=0)\n\nDeltas (atual vs. anterior):\n- Œî absoluto = valor_atual - valor_anterior\n- Œî % = (valor_atual - valor_anterior) / max(Œµ, |valor_anterior|), Œµ=1e-9\n\nClassifica√ß√£o das varia√ß√µes (%):\n- ‚úÖ Melhorou: custo ‚Üì ‚â•10% ou efici√™ncia ‚Üë ‚â•10%\n- ‚öñÔ∏è Est√°vel: entre -10% e +10%\n- ‚ùå Piorou: custo ‚Üë ‚â•10% ou efici√™ncia ‚Üì ‚â•10%\n\n------------------------------------------------------------\n2. Qualidade da amostra\n------------------------------------------------------------\nConsiderar ‚Äúconclusivo‚Äù apenas se:\n- imp_atual ‚â• 1000 ou\n- cliques_link_atual ‚â• 30 ou\n- gasto_atual ‚â• 100\n\nCaso contr√°rio, marque como ‚Äúamostra baixa‚Äù e trate recomenda√ß√µes como explorat√≥rias.\n\n------------------------------------------------------------\n3. Comparar com metas\n------------------------------------------------------------\nMetas de performance:\n- üéØ CPM alvo = R$35,00\n- üéØ CTR alvo = 0,50%\n- üéØ Click‚ÜíLead alvo = 5%\n- üéØ CPL alvo = R$110,00\n\nClassifique cada m√©trica como:\n- ‚¨áÔ∏è Abaixo da meta\n- üü¢ Dentro da meta\n- ‚¨ÜÔ∏è Acima da meta\n\nMostre valor atual, meta e desvio (valor + %).\n\n------------------------------------------------------------\n4. Identificar causas prov√°veis (gargalos do funil)\n------------------------------------------------------------\nUse como guia:\n- üìà CPM alto ‚Üí p√∫blico pequeno, frequ√™ncia alta\n- üñº CTR baixo ‚Üí criativo fraco (gancho, copy, visual, √°udio)\n- üìù Click‚ÜíLead baixo ‚Üí formul√°rio com fric√ß√£o (campos excessivos)\n- üí∏ CPL alto ‚Üí reflexo de gargalos anteriores (CPM, CTR ou Click‚ÜíLead)\n\n------------------------------------------------------------\n5. Recomenda√ß√µes pr√°ticas\n------------------------------------------------------------\nPara cada gargalo identificado, sugira:\n- üñå Criativo ‚Üí novos ganchos, copy, visual, √°udio\n- üéØ Segmenta√ß√£o ‚Üí expandir p√∫blico, excluir faixas ruins\n- üìã Landing/Formul√°rio ‚Üí reduzir atrito, revisar campos obrigat√≥rios\n- üí∞ Or√ßamento/Lances ‚Üí redistribuir verba entre conjuntos melhores\n- ‚ö° Testes A/B ‚Üí validar hip√≥teses rapidamente\n\n------------------------------------------------------------\n6. Estrutura final da an√°lise (sa√≠da)\n------------------------------------------------------------\nO relat√≥rio deve ser entregue em TEXTO, dividido em se√ß√µes com emojis, no seguinte formato:\n\n- üìä **Resumo Executivo** ‚Üí vis√£o geral em 2‚Äì3 frases\n- üìå **Desvios Identificados** ‚Üí tabela/lista com metas vs resultados (√© de extrema import√¢ncia que seja mostrada em uma coluna, a quantidade de leads gerados por cada campanha)\n- üîé **An√°lise dos N√≥s do Funil** ‚Üí explica√ß√£o dos gargalos encontrados\n- üí° **Sugest√µes de Otimiza√ß√£o** ‚Üí recomenda√ß√µes pr√°ticas e acion√°veis\n- üóí **Observa√ß√µes** ‚Üí limita√ß√µes de amostra, mudan√ßas de budget, sazonalidade, etc.\n\n--------------------- 7. NOVA AN√ÅLISE (COMPARATIVA) -------------------------\n## ATEN√á√ÉO: Separar os pr√≥ximos itens da an√°lise principal para que facilite ao gestor de tr√°fego a leitura dos ganhos e perdas em rela√ß√£o √†s ultimas an√°lises de campanha\n\n============================================================\n1) SEU PAPEL\n============================================================\nOBS: Considere como an√°lise atual a an√°lise feita antes de \"7. NOVA AN√ÅLISE (COMPARATIVA)\"\nVoc√™ √© um(a) analista de dados focado(a) em tend√™ncias de performance. Sua miss√£o √© COMPARAR a AN√ÅLISE ATUAL com os DADOS HIST√ìRICOS para identificar padr√µes, evolu√ß√µes e gerar recomenda√ß√µes acion√°veis.\n\n- Use emojis para facilitar a leitura.\n- Gere OBRIGATORIAMENTE uma TABELA de compara√ß√£o das m√©tricas-chave.\n- A compara√ß√£o √© SEMPRE ‚Äúcada per√≠odo HIST√ìRICO vs o PER√çODO ATUAL‚Äù.\n\n============================================================\n2) DADOS DE ENTRADA\n============================================================\n‚Ä¢ Per√≠odo de refer√™ncia da an√°lise atual: {{ $('Formata data').first().json.period_type_translated.toLowerCase() }}.\n‚Ä¢ Hist√≥ricos: JSON com as √∫ltimas an√°lises (anteriores √† atual):\n  {{ JSON.stringify($json) }}\n\nConven√ß√£o de leitura:\n- HIST√ìRICOS: considere que {{ JSON.parse($json.analysis).length }} itens anteriores est√£o em JSON.parse($json.analysis) (array).\n- AN√ÅLISE ATUAL: √© o bloco j√° gerado anteriormente ‚Äúitens 1 a 6‚Äù nesta execu√ß√£o (texto estruturado). Se tamb√©m vier como JSON, nomeie-o internamente de ANALISE_ATUAL_JSON.\n\nCampos esperados por per√≠odo (quando dispon√≠veis):\n- CPL (custo por lead) ‚Äî n√∫mero (R$)\n- CTR (%) ‚Äî n√∫mero (0‚Äì100%)\n- Click‚ÜíLead (%) ‚Äî n√∫mero (0‚Äì100%)\n- CPM (R$) ‚Äî n√∫mero (R$)\n\nSe algum campo estiver ausente em um per√≠odo, marque como ‚Äú‚Äî‚Äù e N√ÉO pare a an√°lise.\n\n============================================================\n3) REGRAS GERAIS (SIGA √Ä RISCA)\n============================================================\nA) Deixe expl√≠cito que a an√°lise considera os √öLTIMOS {{ JSON.parse($json.analysis).length }} PER√çODOS (hist√≥ricos) vs o PER√çODO ATUAL.\nB) A COMPARA√á√ÉO deve ser feita para CADA PER√çODO ANTERIOR vs o ATUAL (n√£o confunda com ‚Äúvs seu per√≠odo anterior‚Äù). \nC) Produza SEMPRE a TABELA de evolu√ß√£o das 4 m√©tricas (CPL, CTR, Click‚ÜíLead, CPM). Sem tabela = ERRO.\nD) √çcones de tend√™ncia (ao comparar um per√≠odo X com o ATUAL):\n   ‚Ä¢ üìà melhora\n   ‚Ä¢ üìâ piora\n   ‚Ä¢ ‚ûñ estabilidade (varia√ß√£o absoluta < 2% para percentuais; < 2% do valor do ATUAL para valores monet√°rios)\nE) Formata√ß√£o dos valores:\n   ‚Ä¢ R$ com duas casas decimais: R$ 123,45\n   ‚Ä¢ % com duas casas decimais: 12,34%\nF) Ordene os per√≠odos do mais antigo ‚Üí mais recente ‚Üí ATUAL.\nG) Nunca invente m√©tricas: apenas calcule/extraia do que foi fornecido.\nH) Se houver diverg√™ncia de nomes de campos (ex.: cpl vs CPL), normalize para as 4 m√©tricas-padr√£o.\nI) Se um valor vier como string, fa√ßa parsing seguro. Caso falhe, trate como ausente (‚Äú‚Äî‚Äù).\nJ) N√£o use HTML; apenas texto e tabela em Markdown.\n\n============================================================\n4) PASSOS (ALGORITMO)\n============================================================\n1. Parseie os HIST√ìRICOS: hist = JSON.parse($json.analysis) ‚Üí array de per√≠odos anteriores.\n2. Identifique/extraia, para cada per√≠odo hist√≥rico, os 4 campos (CPL, CTR, Click‚ÜíLead, CPM). Normalize nomes.\n3. Identifique os MESMOS 4 campos na AN√ÅLISE ATUAL (a partir do bloco ‚Äúitens 1 a 6‚Äù ou de ANALISE_ATUAL_JSON, se dispon√≠vel).\n4. Calcule a varia√ß√£o de cada per√≠odo ANTERIOR em rela√ß√£o ao ATUAL:\n   - Para %: Œî% = (ValorAnterior - ValorAtual) / |ValorAtual|\n   - Para R$: ŒîR$% = (ValorAnterior - ValorAtual) / |ValorAtual|\n   - Sinal: ‚Äúüìà‚Äù quando a dire√ß√£o √© positiva para a m√©trica (ex.: CPL menor √© melhor; CTR/Click‚ÜíLead maior √© melhor; CPM menor √© melhor).\n     ‚Ä¢ M√©tricas ‚Äúmenor √© melhor‚Äù: CPL, CPM\n     ‚Ä¢ M√©tricas ‚Äúmaior √© melhor‚Äù: CTR, Click‚ÜíLead\n   - Aplique ‚Äú‚ûñ‚Äù se |Œî| < 0,02 (2%).\n5. Monte a TABELA (ver se√ß√£o 5), incluindo coluna do ATUAL e, para cada per√≠odo anterior, o valor e o √≠cone vs ATUAL.\n6. Com base na tabela, produza ‚ÄúGanhos Not√°veis‚Äù e ‚ÄúPerdas Cr√≠ticas‚Äù (se√ß√£o 6), com bullets curtos e objetivos.\n7. Gere ‚ÄúInsights e Pr√≥ximos Passos‚Äù (se√ß√£o 7) com recomenda√ß√µes espec√≠ficas e priorizadas.\n8. Se algum dado estiver ausente, mantenha a tabela e explique em uma nota final o que faltou.\n\n============================================================\n5) SA√çDA ‚Äî SE√á√ÉO 1: üìä TABELA DE EVOLU√á√ÉO DE M√âTRICAS\n============================================================\n- TITULE claramente: ‚Äúüìä Tabela de Evolu√ß√£o de M√©tricas ‚Äî {{ JSON.parse($json.analysis).length }} per√≠odos anteriores vs Atual ({{ $('Formata data').first().json.period_type_translated.toLowerCase() }})‚Äù\n- Linhas = m√©tricas (CPL, CTR, Click‚ÜíLead, CPM).\n- Colunas = Per√≠odo 1 (mais antigo) | ... | Per√≠odo N (mais recente) | ATUAL.\n- Em cada c√©lula de PER√çODO ANTERIOR, mostre o valor + √≠cone vs ATUAL. Na coluna ATUAL, mostre apenas o valor.\n- EXEMPLO (apenas ilustrativo; adapte aos seus dados):\n\n| M√©trica                | ATUAL    | Per√≠odo -{{JSON.parse($json.analysis).length}} |  ... | Per√≠odo -1    |\n|------------------------|-----------------------------------------------------------|------|---------------|\n| CPL                    | R$ 80,00 | R$ 110,00 üìâ                                   | ...  | R$ 95,00 üìâ  |\n| CTR                    | 1,50%    | 0,80% üìâ                                       | ...  | 1,20% üìâ     |\n| Click‚ÜíLead             | 15,00%   | 10,00% üìâ                                      | ...  | 13,00% üìâ    |\n| CPM                    | R$ 30,00 | R$ 40,00 üìà                                    | ...  | R$ 28,00 üìà  |\n| Total de Leads Gerados | 21       | 18                                             | ...  | 19           | -> Aqui deve ser somado o total de leads para cada campanha (fazendo isso na an√°lise atual e nas √∫ltimas an√°lises)\n\n(Interpreta√ß√£o do √≠cone vs ATUAL: se a m√©trica for ‚Äúmenor √© melhor‚Äù e o per√≠odo anterior tiver valor MAIOR que o ATUAL ‚Üí üìâ; se MENOR ‚Üí üìà; se ~igual (Œî<2%) ‚Üí ‚ûñ. Para m√©tricas ‚Äúmaior √© melhor‚Äù, a l√≥gica se inverte.)\n\nATEN√á√ÉO M√ÅXIMA: \n- A TABELA √â OBRIGAT√ìRIA. SEM TABELA = FALHA.\n\n\n============================================================\n6) SA√çDA ‚Äî SE√á√ÉO 2: üèÜ GANHOS NOT√ÅVEIS vs üíî PERDAS CR√çTICAS\n============================================================\nEscreva bullets diretos, comparando ATUAL vs hist√≥ricos.\n\n- Ganhos Not√°veis ‚úÖ:\n  ‚Ä¢ Ex.: ‚Äú‚úÖ **CPL em queda:** redu√ß√£o m√©dia de 22% vs m√©dia hist√≥rica ({{ JSON.parse($json.analysis).length }} per√≠odos).‚Äù\n  ‚Ä¢ Ex.: ‚Äú‚úÖ **CTR em alta:** acima do percentil 75% hist√≥rico.‚Äù\n\n- Perdas Cr√≠ticas ‚ùå:\n  ‚Ä¢ Ex.: ‚Äú‚ùå **Click‚ÜíLead em alerta:** -40% vs ATUAL no Per√≠odo -1, sugerindo atrito no formul√°rio/p√°gina.‚Äù\n  ‚Ä¢ Ex.: ‚Äú‚ùå **CPM pressionado:**  +18% vs ATUAL em metade dos per√≠odos, indicando leil√£o mais caro.‚Äù\n\n============================================================\n7) SA√çDA ‚Äî SE√á√ÉO 3: üí° INSIGHTS PARA A PR√ìXIMA PERFORMANCE\n============================================================\nEstruture em quatro blocos curtos e pr√°ticos:\n\n- Padr√£o Emergente? üìàüìâ\n  ‚Ä¢ Descreva padr√µes claros (ex.: queda recorrente de CTR de 2 em 2 per√≠odos; sazonalidade; satura√ß√£o de criativos).\n\n- O que funcionou e devemos REPETIR? üîÅ\n  ‚Ä¢ Aponte t√°ticas, p√∫blicos, formatos ou canais associados a melhores resultados nos hist√≥ricos.\n\n- O que falhou e devemos EVITAR? üõë\n  ‚Ä¢ Cite o que puxou as piores varia√ß√µes (ex.: v√≠deos >30s elevaram CPM; downgrade de p√∫blico; limita√ß√£o de verba).\n\n- Pr√≥ximo Experimento Sugerido üß™\n  ‚Ä¢ Defina UM teste A/B priorit√°rio, diretamente ligado √† pior queda ou maior oportunidade (ex.: teste de landing com menos campos para recuperar Click‚ÜíLead).\n\n============================================================\n8) NOTAS FINAIS & ROBUSTEZ\n============================================================\n- Se algum campo n√£o existir em um per√≠odo: use ‚Äú‚Äî‚Äù e siga adiante.\n- Se os nomes divergirem (ex.: ‚Äúcost_per_lead‚Äù): normalize para CPL.\n- Arredondamento: duas casas decimais para R$ e %.\n- Estabilidade: use ‚Äú‚ûñ‚Äù quando |Œî| < 2%.\n- Esclare√ßa explicitamente: ‚ÄúBase: √∫ltimos {{ JSON.parse($json.analysis).length }} per√≠odos vs atual ({{ $('Formata data').first().json.period_type_translated.toLowerCase() }}).‚Äù\n\n============================================================\n9) MODELO DE RESPOSTA (SOMENTE REFER√äNCIA)\n============================================================\nüîé Base da an√°lise: √∫ltimos {{ JSON.parse($json.analysis).length }} per√≠odos vs ATUAL ({{ $('Formata data').first().json.period_type_translated.toLowerCase() }}).\n\n1) üìä Tabela de Evolu√ß√£o de M√©tricas\n\n2) üèÜ Ganhos Not√°veis ‚úÖ\n- ...\n\nüíî Perdas Cr√≠ticas ‚ùå\n- ...\n\n3) üí° Insights e Pr√≥ximos Passos\n- Padr√£o Emergente? üìàüìâ: ...\n- Repetir üîÅ: ...\n- Evitar üõë: ...\n- Pr√≥ximo Experimento üß™: ...\n\n(Observa√ß√µes: m√©tricas ausentes marcadas como ‚Äú‚Äî‚Äù. Emojis indicam varia√ß√£o do per√≠odo ANTERIOR vs ATUAL.)\n\nüß≠ ORDEM DAS DATAS (IMPORTANTE)\n\nNa tabela de evolu√ß√£o de m√©tricas, as colunas devem estar em ordem cronol√≥gica decrescente, ou seja:\ncomece pelo per√≠odo ATUAL ‚Üí depois o mais recente ‚Üí at√© o mais antigo.\n\nExemplo esperado:\n\nM√©trica\tATUAL\t    Per√≠odo -1\t Per√≠odo -2\t    Per√≠odo -3    Per√≠odo -4\nCPL\t    R$ 85,00\tR$ 90,00 üìà\t R$ 95,00 üìà\tR$ 110,00 üìà  R$ 75,00 üìà\n\n‚ö†Ô∏è Regra simples:\n \n- Sempre ordenar da data mais nova para a mais antiga (ATUAL primeiro).\n\n- Quer que eu adicione essa instru√ß√£o direto na se√ß√£o 5) SA√çDA ‚Äî SE√á√ÉO 1: üìä TABELA DE EVOLU√á√ÉO DE M√âTRICAS, j√° embutida no prompt completo pra substituir o trecho antigo?\n","options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.2,"position":[224,80],"id":"a724e7e0-a125-4971-9fef-6ca57fb6edff","name":"AI - Criar relat√≥rio"},{"parameters":{"promptType":"define","text":"=Sua missao √© gerar um HTML com base nas informacoes do json {{ $('AI - Criar relat√≥rio').item.json.output }} que contem as informa√ß√µes tecnicas do relat√≥rio. Seu HTML output deve seguir sempre a mesma estrutura de layout seguindo o template abaixo, adaptando apenas a inclusao das informa√ß√µes com base no json passado anteriormente.\n\nATEN√á√ÉO:\n\nAtualmente, a an√°lise evolutiva/comparativa est√° no final do relat√≥rio, ap√≥s a an√°lise do per√≠odo. \n* Apenas para formata√ß√£o: \n- Alocar a an√°lise evolutiva/comparativa para o in√≠cio do template HTML que ser√° gerado.\n- Na coluna \"ATUAL\" da tabela comparativa de m√©tricas, quando o valor corresponder a meta estipulada, deve estar em verde, caso o contr√°rio, deve estar em vermelho (O t√≠tlo da coluna n√£o deve ter colora√ß√£o baseada no atingimento da meta estipu).\n\nTemplate:\n\n<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Relat√≥rio de Performance - Meta Ads</title>\n</head>\n<body style=\"margin:0; padding:0; font-family:Arial, sans-serif; background-color:#f5f5f5;\">\n  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background-color:#f5f5f5; padding: 20px 0;\">\n    <tr>\n      <td align=\"center\">\n        <table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background-color:#ffffff; border-radius:10px; padding:30px;\">\n          <tr>\n            <td align=\"center\" style=\"padding-bottom:20px;\">\n              <h1 style=\"color:#1a1a1a; font-size:24px; margin:0;\">üìä Relat√≥rio de Performance</h1>\n              <p style=\"color:#666666; font-size:14px; margin:5px 0 0;\">Meta Ads ‚Ä¢ An√°lise Detalhada de Campanhas</p>\n            </td>\n          </tr>\n\n          <!-- Resumo Executivo -->\n          <tr>\n            <td style=\"padding:20px 0; border-top:1px solid #eaeaea;\">\n              <h2 style=\"font-size:18px; color:#1a1a1a; margin-bottom:10px;\">Resumo Executivo</h2>\n              <p style=\"font-size:14px; color:#444444; line-height:1.6;\">\n                A campanha apresenta <strong>performance mista</strong> com pontos positivos e cr√≠ticos. O CTR est√° quase <strong>2x acima da meta</strong>, por√©m o CPM elevado e a baixa convers√£o Click ‚Üí Lead est√£o impactando significativamente o CPL final, que ficou <strong>20% abaixo da meta</strong> estabelecida.\n              </p>\n            </td>\n          </tr>\n\n          <!-- M√©tricas Principais -->\n          <tr>\n            <td style=\"padding:20px 0;\">\n              <table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"0\" style=\"background-color:#fafafa; border-radius:8px;\">\n                <tr>\n                  <td>\n                    <strong>CPM:</strong><br>\n                    <span style=\"font-size:20px; color:#1a1a1a;\">R$ 44,47</span><br>\n                    <span style=\"color:#666;\">Meta: R$ 50,00</span><br>\n                    <span style=\"color:#dc2626;\">-R$ 5,53 (-11,06%)</span>\n                  </td>\n                  <td>\n                    <strong>CTR:</strong><br>\n                    <span style=\"font-size:20px; color:#1a1a1a;\">0,97%</span><br>\n                    <span style=\"color:#666;\">Meta: 0,50%</span><br>\n                    <span style=\"color:#166534;\">+0,47% (+94%)</span>\n                  </td>\n                </tr>\n                <tr>\n                  <td>\n                    <strong>Click ‚Üí Lead:</strong><br>\n                    <span style=\"font-size:20px; color:#1a1a1a;\">5,78%</span><br>\n                    <span style=\"color:#666;\">Meta: 10,00%</span><br>\n                    <span style=\"color:#dc2626;\">-4,22% (-42,2%)</span>\n                  </td>\n                  <td>\n                    <strong>CPL:</strong><br>\n                    <span style=\"font-size:20px; color:#1a1a1a;\">R$ 79,61</span><br>\n                    <span style=\"color:#666;\">Meta: R$ 100,00</span><br>\n                    <span style=\"color:#166534;\">-R$ 20,39 (-20,39%)</span>\n                  </td>\n                </tr>\n              </table>\n            </td>\n          </tr>\n\n          <!-- Pontos Fortes -->\n          <tr>\n            <td style=\"padding:20px 0;\">\n              <h2 style=\"font-size:18px; color:#1a1a1a;\">‚úÖ Pontos Fortes</h2>\n              <ul style=\"color:#444; font-size:14px; padding-left:20px;\">\n                <li><strong>CTR excepcional (0,97%)</strong>: Os criativos est√£o muito atrativos</li>\n                <li><strong>CPM controlado</strong>: Boa escolha de p√∫blico</li>\n              </ul>\n            </td>\n          </tr>\n\n          <!-- Gargalos -->\n          <tr>\n            <td style=\"padding:20px 0;\">\n              <h2 style=\"font-size:18px; color:#1a1a1a;\">‚ö†Ô∏è Gargalo Principal</h2>\n              <p style=\"font-size:14px; color:#444;\">\n                Convers√£o Click ‚Üí Lead (5,78%) est√° abaixo da meta.<br>\n                <strong>Causa prov√°vel:</strong> Excesso de fric√ß√£o no formul√°rio de captura.\n              </p>\n              <ul style=\"color:#444; font-size:14px; padding-left:20px;\">\n                <li>Campos demais</li>\n                <li>Formul√°rio mal posicionado</li>\n                <li>Falta de prova social</li>\n              </ul>\n            </td>\n          </tr>\n\n          <!-- Sugest√µes -->\n          <tr>\n            <td style=\"padding:20px 0;\">\n              <h2 style=\"font-size:18px; color:#1a1a1a;\">üí° Sugest√µes de Otimiza√ß√£o</h2>\n\n              <p style=\"font-size:14px; color:#1a1a1a; margin:10px 0;\"><strong>üü• Alta Prioridade ‚Äì Otimiza√ß√£o do Formul√°rio:</strong></p>\n              <ul style=\"color:#444; font-size:14px; padding-left:20px;\">\n                <li>Reduzir campos (Nome, WhatsApp, E-mail)</li>\n                <li>Formul√°rio em etapas</li>\n                <li>Prova social pr√≥xima ao formul√°rio</li>\n                <li>Posicionar \"acima da dobra\"</li>\n              </ul>\n\n              <p style=\"font-size:14px; color:#1a1a1a; margin:10px 0;\"><strong>üü• Alta Prioridade ‚Äì Landing Page:</strong></p>\n              <ul style=\"color:#444; font-size:14px; padding-left:20px;\">\n                <li>A/B test com vers√£o simplificada</li>\n                <li>Copy alinhada ao an√∫ncio</li>\n                <li>Senso de urg√™ncia e escassez</li>\n              </ul>\n\n              <p style=\"font-size:14px; color:#1a1a1a; margin:10px 0;\"><strong>üü® M√©dia Prioridade ‚Äì Escalonamento Inteligente:</strong></p>\n              <ul style=\"color:#444; font-size:14px; padding-left:20px;\">\n                <li>Aumentar or√ßamento gradualmente</li>\n                <li>Duplicar conjuntos de alta performance</li>\n              </ul>\n\n              <p style=\"font-size:14px; color:#1a1a1a; margin:10px 0;\"><strong>üü® M√©dia Prioridade ‚Äì Testes Cont√≠nuos:</strong></p>\n              <ul style=\"color:#444; font-size:14px; padding-left:20px;\">\n                <li>Manter rota√ß√£o de criativos</li>\n                <li>Testar novos p√∫blicos semelhantes</li>\n              </ul>\n            </td>\n          </tr>\n\n          <!-- Footer -->\n          <tr>\n            <td style=\"padding-top:20px; border-top:1px solid #eaeaea; text-align:center;\">\n              <p style=\"font-size:14px; color:#1a1a1a;\"><strong>üéØ Meta Imediata:</strong> Aumentar a taxa de convers√£o Click ‚Üí Lead de 5,78% para 8% nas pr√≥ximas 2 semanas.</p>\n            </td>\n          </tr>\n        </table>\n      </td>\n    </tr>\n  </table>\n\n-- Seguindo a mesma estrutura de HTML, coloque a an√°lise comparativa a seguir.\n</body>\n</html>\n\n\n\nEste html ser√° utilizado em um email, e por isso voc√™ deve devolver apenas o HTML, 100% funcional e organizado. Em sua entrega final (output), nunca inclua \"```json\\n{\\n \"html\": \"\"ou algo do tipo. Apenas o HTML funcional.","options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.2,"position":[800,80],"id":"7dd4d156-39b5-44a4-a0a6-61fbb91f81d6","name":"AI - Criar HTML","executeOnce":false},{"parameters":{"rule":{"interval":[{"triggerAtHour":8}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-1808,-64],"id":"5d982346-e384-4749-b2ad-40a3d965b5c0","name":"Cron di√°rio"},{"parameters":{"rule":{"interval":[{"field":"weeks","triggerAtHour":8}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-1808,192],"id":"0b3a60bc-ad44-4d90-af0b-54ccf8037026","name":"Cron semanal"},{"parameters":{"jsCode":"return $input.first().json"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-1296,80],"id":"cbb66ffc-f464-4b50-9722-661baa8adcf3","name":"Formata data"},{"parameters":{"jsCode":"const period_type_translated = 'Di√°rio'\nreturn {\n  date_preset: \"yesterday\",\n  period_type: \"daily\",\n  period_type_translated,\n  text: (() => {\n    const d = new Date();\n    d.setDate(d.getDate() - 1);\n    const fmt = x => `${String(x.getDate()).padStart(2,'0')}/${String(x.getMonth()+1).padStart(2,'0')}/${x.getFullYear()}`;\n    return `${period_type_translated} - ${fmt(d)}`;\n  })()\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-1600,-64],"id":"3a314160-aa70-4cfb-94f1-e5c307c03860","name":"Normaliza dados di√°rios"},{"parameters":{"jsCode":"const period_type_translated = 'Semanal'\nreturn {\n  date_preset: \"last_7d\",\n  period_type: \"weekly\",\n  period_type_translated,\n  text: (() => {\n    const end = new Date();\n    const start = new Date();\n    start.setDate(end.getDate() - 7);\n    const fmt = d => `${String(d.getDate()).padStart(2,'0')}/${String(d.getMonth()+1).padStart(2,'0')}/${d.getFullYear()}`;\n    return `${period_type_translated} - ${fmt(start)} at√© ${fmt(end)}`;\n  })()\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-1600,192],"id":"d1113f76-08cf-4cee-9668-b11e38aa8257","name":"Normaliza dados semanais"},{"parameters":{"jsCode":"return {\n  analysis: JSON.stringify($input.all())\n}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-16,80],"id":"978b1aae-ed72-4e7d-8b68-bb30c7d68cf1","name":"Transforma an√°lises em texto"},{"parameters":{"operation":"select","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"campaign_analysis","mode":"list","cachedResultName":"campaign_analysis"},"limit":4,"where":{"values":[{"column":"period_type","value":"={{ $('Formata data').item.json.period_type }}"}]},"sort":{"values":[{"column":"id","direction":"DESC"}]},"options":{"outputColumns":["created_at","period_type","analysis"]}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[-224,80],"id":"440676c4-5657-4fa9-ab4f-5b8897c66232","name":"Busca relat√≥rios salvos no banco de dados","alwaysOutputData":true,"credentials":{"postgres":{"id":"pXgXB3fm4CWNM9Pd","name":"Postgres account"}}},{"parameters":{"schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"campaign_analysis","mode":"list","cachedResultName":"campaign_analysis"},"columns":{"mappingMode":"defineBelow","value":{"analysis":"={{ $json.output }}","period_type":"={{ $('Formata data').first().json.period_type }}","ads_name":"Meta"},"matchingColumns":["id"],"schema":[{"id":"id","displayName":"id","required":false,"defaultMatch":true,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"analysis","displayName":"analysis","required":true,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"ads_name","displayName":"ads_name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"period_type","displayName":"period_type","required":true,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"created_at","displayName":"created_at","required":false,"defaultMatch":false,"display":true,"type":"dateTime","canBeUsedToMatch":true},{"id":"updated_at","displayName":"updated_at","required":false,"defaultMatch":false,"display":true,"type":"dateTime","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[576,80],"id":"72fbc367-4306-480c-ac36-847754a76ea4","name":"Insere novo relat√≥rio gerado no banco de dados","credentials":{"postgres":{"id":"pXgXB3fm4CWNM9Pd","name":"Postgres account"}}},{"parameters":{"fromEmail":"Apresenta.me <no-reply@apresenta.me>","toEmail":"joao.rorato@apresenta.me, maicon@apresenta.me, guilherme.lindner@apresenta.me, erickmacielmazanti@gmail.com, bianca.gimenez@aguialeao.com.br","subject":"=üìä An√°lise de Campanhas | {{ $('Formata data').first().json.text }}","html":"={{ $json.output }}","options":{"appendAttribution":false,"ccEmail":"="}},"type":"n8n-nodes-base.emailSend","typeVersion":2.1,"position":[1168,80],"id":"ac00e791-9716-483e-b14e-e2e5c4039bfd","name":"Envia por e-mail","webhookId":"b8842732-9025-4c04-924e-06cfbb051a19","notesInFlow":false,"credentials":{"smtp":{"id":"aeF6k2hPp8cZPPHg","name":"SMTP account"}}}],"connections":{"Pega os ids das campanhas com insights":{"main":[[{"node":"Busca campanhas","type":"main","index":0}]]},"Junta as informa√ß√µes de campanha com insights":{"main":[[{"node":"Busca relat√≥rios salvos no banco de dados","type":"main","index":0}]]},"Busca insights":{"main":[[{"node":"Pega os ids das campanhas com insights","type":"main","index":0}]]},"Busca campanhas":{"main":[[{"node":"Junta as informa√ß√µes de campanha com insights","type":"main","index":0}]]},"Anthropic Chat Model2":{"ai_languageModel":[[{"node":"AI - Criar relat√≥rio","type":"ai_languageModel","index":0}]]},"Anthropic Chat Model3":{"ai_languageModel":[[{"node":"AI - Criar HTML","type":"ai_languageModel","index":0}]]},"AI - Criar relat√≥rio":{"main":[[{"node":"Insere novo relat√≥rio gerado no banco de dados","type":"main","index":0}]]},"AI - Criar HTML":{"main":[[{"node":"Envia por e-mail","type":"main","index":0}]]},"Cron di√°rio":{"main":[[{"node":"Normaliza dados di√°rios","type":"main","index":0}]]},"Cron semanal":{"main":[[{"node":"Normaliza dados semanais","type":"main","index":0}]]},"Formata data":{"main":[[{"node":"Busca insights","type":"main","index":0}]]},"Normaliza dados di√°rios":{"main":[[{"node":"Formata data","type":"main","index":0}]]},"Normaliza dados semanais":{"main":[[{"node":"Formata data","type":"main","index":0}]]},"Transforma an√°lises em texto":{"main":[[{"node":"AI - Criar relat√≥rio","type":"main","index":0}]]},"Busca relat√≥rios salvos no banco de dados":{"main":[[{"node":"Transforma an√°lises em texto","type":"main","index":0}]]},"Insere novo relat√≥rio gerado no banco de dados":{"main":[[{"node":"AI - Criar HTML","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":{"node:Cron di√°rio":{"recurrenceRules":[]},"node:Cron semanal":{"recurrenceRules":[]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{"Cron di√°rio":[{"json":{"timestamp":"2025-11-03T08:00:33.006-03:00","Readable date":"November 3rd 2025, 8:00:33 am","Readable time":"8:00:33 am","Day of week":"Monday","Year":"2025","Month":"November","Day of month":"03","Hour":"08","Minute":"00","Second":"33","Timezone":"America/Sao_Paulo (UTC-03:00)"}}]},"versionId":"68505985-23e2-459d-8836-0cc67a0a8271","triggerCount":2,"shared":[{"createdAt":"2025-09-22T19:32:48.296Z","updatedAt":"2025-09-22T19:32:48.296Z","role":"workflow:owner","workflowId":"YxaBUSS3T4m872sV","projectId":"4ToGMYJEWvvDSbcz"}],"tags":[]}