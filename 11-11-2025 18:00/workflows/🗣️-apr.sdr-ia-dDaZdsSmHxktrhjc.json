{"updatedAt":"2025-11-11T20:59:14.000Z","createdAt":"2025-11-04T18:47:16.651Z","id":"dDaZdsSmHxktrhjc","name":"üó£Ô∏è Apr.SDR IA","active":true,"isArchived":false,"nodes":[{"parameters":{"options":{"dimensions":1536}},"type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1.2,"position":[2352,960],"id":"a7f10ff1-4967-4ed0-8aa7-f99ee2a6cdf0","name":"Embeddings OpenAI","credentials":{"openAiApi":{"id":"weD4ayyAuWgClQqA","name":"OpenAi account"}}},{"parameters":{"options":{"systemMessage":"=## Identidade\nVoc√™ √© {{ $('Seta perfil').item.json.agentName }} ‚Äì {{ $('Seta perfil').item.json.role }} da {{ $('Seta perfil').item.json.companyName }}.\nIdioma: {{ $('Seta perfil').item.json.language }}\nMensagem inicial (somente se for a primeira intera√ß√£o): {{ $('Seta perfil').item.json.initialMessage }}\n\n## Comportamento\n{{ $('Seta perfil').item.json.conduct }}\n\n## Objetivo\nConduzir a conversa seguindo corretamente os est√°gios, coletando os dados obrigat√≥rios de cada est√°gio, atualizando as vari√°veis quando forem identificadas nas mensagens do usu√°rio e avan√ßando para o pr√≥ximo est√°gio somente quando o atual estiver conclu√≠do. Nunca repetir est√°gios j√° finalizados.\n\n## Regras Gerais\n- Fale de forma humana, cordial e clara.\n- N√£o explique sua l√≥gica interna.\n- N√£o mencione est√°gios, vari√°veis ou processos internos.\n- N√£o pule etapas.\n- N√£o pergunte novamente informa√ß√µes j√° coletadas.\n- Se o usu√°rio corrigir uma informa√ß√£o, atualize a vari√°vel.\n\n## Atualiza√ß√£o de Vari√°veis\nSempre que a mensagem do usu√°rio contiver uma informa√ß√£o que corresponda a qualquer vari√°vel em:\n{{ Object.keys($('Seta vari√°veis da conversa').first().json.data) }}\n\n1. Identifique o valor.\n2. Normalize somente se estiver claro. Se existir possibilidade de ambiguidade, pergunte para confirmar ao inv√©s de salvar.\n3. Para cada vari√°vel encontrada, execute a tool AtualizarVariavel ANTES de responder, no formato EXATO:\n{ \"name\": \"<nome_da_variavel>\", \"value\": \"<valor_obtido>\" }\n4. Uma chamada separada para cada vari√°vel identificada.\n5. Ap√≥s executar todas as tool calls necess√°rias, responda seguindo o fluxo do est√°gio atual.\n\n## Como identificar o est√°gio atual (ALGORITMO DETERMIN√çSTICO)\n1. Liste todos os est√°gios pela ordem do campo sortNumber (do menor para o maior).\n2. Para cada est√°gio, nessa ordem:\n   a. Se o est√°gio j√° est√° conclu√≠do, pule para o pr√≥ximo.\n   b. Caso n√£o esteja conclu√≠do:\n       - Verifique a lista actions.requiredDataForExecute.\n       - Identifique quais vari√°veis dessa lista ainda N√ÉO possuem valor.\n       - Se existir pelo menos uma vari√°vel sem valor:\n            ‚Üí Este √© o est√°gio atual.\n            ‚Üí Voc√™ deve perguntar SOMENTE a instru√ß√£o da PRIMEIRA vari√°vel ainda sem valor.\n            ‚Üí Pare a an√°lise aqui.\n       - Se TODAS as vari√°veis j√° possuem valor:\n            ‚Üí Execute a finalInstructions deste est√°gio.\n            ‚Üí Marque o est√°gio como conclu√≠do.\n            ‚Üí Pare a an√°lise aqui.\n3. Nunca selecione um est√°gio baseado em interpreta√ß√£o, contexto ou inten√ß√£o. A escolha √© sempre feita exclusivamente pela presen√ßa ou aus√™ncia de valores obrigat√≥rios.\n\n## O que retornar em cada resposta\n- Se ainda houver vari√°vel obrigat√≥ria sem valor no est√°gio atual:\n  ‚Üí Pergunte apenas a instru√ß√£o dessa vari√°vel.\n- Se todas vari√°veis do est√°gio atual estiverem preenchidas:\n  ‚Üí Execute apenas a finalInstructions do est√°gio.\n- N√£o inclua nada al√©m disso.\n- N√£o improvise, n√£o reescreva perguntas, n√£o adicione contexto.\n\n## Importante\n- Um est√°gio s√≥ √© conclu√≠do quando todas as vari√°veis obrigat√≥rias estiverem preenchidas e a finalInstructions for executada.\n- Um est√°gio conclu√≠do nunca deve ser repetido, a menos que o usu√°rio forne√ßa uma corre√ß√£o de informa√ß√£o.\n\n## Est√°gios\n{{ JSON.stringify($('Compacta JSON est√°gios').item.json.stages) }}\n\n# Legenda do JSON de est√°gios:\n{{ JSON.stringify($('Retorna legenda dos est√°gios').item.json.legend) }}\n","returnIntermediateSteps":true}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2,"position":[2128,384],"id":"e4c2cdb8-41e6-4644-9ee1-b4299d946e0c","name":"AI Agent","retryOnFail":false},{"parameters":{"mode":"retrieve-as-tool","toolDescription":"=## üß† Apre.IA ‚Äì Consulta √† Base de Conhecimento  \n**Fun√ß√£o:** Buscar trechos da **KB da Apresenta.me** sobre produtos, servi√ßos, processos e materiais oficiais.\n\n### Instru√ß√µes  \n- Buscar **somente** informa√ß√µes da Apresenta.me.  \n- Retornar trechos **curtos e objetivos** (at√© ~200 tokens).  \n- **Nunca inventar** dados, prazos, valores ou pol√≠ticas.  \n- Priorizar **vers√µes recentes**.  \n- Ignorar mensagens gen√©ricas ou sauda√ß√µes.  \n- Se n√£o houver correspond√™ncia clara ‚Üí **retornar vazio** (sem tentativa de resposta). \n","tableName":"n8","options":{}},"type":"@n8n/n8n-nodes-langchain.vectorStorePGVector","typeVersion":1.3,"position":[2352,800],"id":"61be998c-9c3d-440c-b661-389b0c721ab7","name":"Busca informa√ß√µes do banco de dados","credentials":{"postgres":{"id":"pXgXB3fm4CWNM9Pd","name":"Postgres account"}}},{"parameters":{"jsCode":"return {chatInput: $input.first().json.body.message}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-144,384],"id":"9ce388d5-9cd4-4686-9556-333b2dcd797b","name":"Retorna message"},{"parameters":{"method":"POST","url":"=https://api-chat-joao.apre.tv/api/messages/send","sendHeaders":true,"specifyHeaders":"json","jsonHeaders":"={\n    \"accept\": \"application/json, text/plain, */*\",\n    \"accept-language\": \"pt-BR,pt;q=0.9,en-US;q=0.8,en;q=0.7\",\n    \"authorization\": \"Bearer kZaOTd+YZpjRUyyuQUpigJaEMk4vcW4YOymKPZX0Ts8=\",\n    \"company\": {{ $('Webhook').item.json.body.companyId }},\n    \"content-type\": \"application/json\"\n  } ","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"name":"message","value":"={{ $('AI Agent').item.json.output }}"},{"name":"number","value":"={{ $('Webhook').item.json.body.contact.name }}"},{"name":"addUserName","value":"={{ $('Seta perfil').item.json.agentName }}"},{"name":"whatsappId","value":"={{ $('Webhook').item.json.body.whatsappId }}"},{"name":"messageRepliedId","value":"={{ $('Webhook').item.json.body.messageId }}"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[2464,384],"id":"51055a9d-03f0-4191-a0ba-476cb7be2d68","name":"HTTP Request"},{"parameters":{"jsCode":"function cleanText(s) {\n  if (!s) return \"\";\n  // remove markdown leve e m√∫ltiplos espa√ßos\n  s = s.replace(/[\\*_~`]+/g, \"\")\n       .replace(/\\s+/g, \" \")\n       .trim();\n  // corta para 220 chars\n  if (s.length > 220) s = s.slice(0, 217) + \"‚Ä¶\";\n  return s;\n}\n\nfunction roleFrom(msg) {\n  // dataJson.key.fromMe === true => agente (a); caso contr√°rio, usu√°rio (u)\n  const fromMe = msg?.dataJson?.key?.fromMe === true || msg?.fromMe === true;\n  return fromMe ? \"a\" : \"u\";\n}\n\nfunction tsFrom(msg) {\n  return msg.updatedAt || msg.createdAt || null;\n}\n\nfunction isNoise(t) {\n  if (!t) return true;\n  const low = t.toLowerCase();\n  const greetings = [\"oi\", \"ola\", \"ol√°\", \"opa, tudo bem?\", \"ooooii\"];\n  if (greetings.includes(low)) return true;\n  if (low.length < 2) return true;\n  return false;\n}\n\nconst raw = JSON.parse($('Webhook').first().json.body.lastMessages) || [];\nconsole.log({ raw })\nconst mapped = raw.map(m => ({\n  r: roleFrom(m),\n  t: cleanText(m.body || m?.dataJson?.message?.conversation || \"\"),\n  ts: tsFrom(m)\n}))\n.filter(m => !isNoise(m.t));\n\n// manter somente √∫ltimas 10 √∫teis (ordenar por ts asc e pegar tail)\nmapped.sort((a,b) => (new Date(a.ts||0)) - (new Date(b.ts||0)));\nconst trimmed = mapped;\n\n// mesclar mensagens consecutivas do mesmo role quando for continua√ß√£o simples\nconst merged = [];\nfor (const m of trimmed) {\n  const last = merged[merged.length - 1];\n  if (last && last.r === m.r && (last.t + \" \" + m.t).length <= 220) {\n    last.t = cleanText(last.t + \" \" + m.t);\n    last.ts = m.ts; // manter o timestamp mais recente do bloco\n  } else {\n    merged.push({...m});\n  }\n}\n\nreturn {\n  chatInput: $input.first().json.chatInput,\n  lastMessageCompact: JSON.stringify(merged)\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[32,384],"id":"696b4483-d758-47cc-b36f-ea3ae85fa934","name":"Compacta as √∫ltimas mensagens"},{"parameters":{"model":{"__rl":true,"value":"gpt-4o-mini","mode":"list","cachedResultName":"gpt-4o-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[2000,656],"id":"ad961793-d5f5-42d4-821c-94265a99089e","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"weD4ayyAuWgClQqA","name":"OpenAi account"}}},{"parameters":{"httpMethod":"POST","path":"7223c6af-f595-4bc2-b84c-602b8900cd08","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[-320,384],"id":"265dfdd6-e7e3-4cab-8841-8fec8945c49f","name":"Webhook","webhookId":"7223c6af-f595-4bc2-b84c-602b8900cd08"},{"parameters":{"jsCode":"return {\n  output: $input.first().json.output || JSON.parse($('Se tiver resumo').first().json.propertyName),\n  chatInput: $('Webhook').first().json.body.message\n}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-896,1664],"id":"8a714e10-91f5-45a7-9c03-cab733f09e07","name":"Transforma resumo em objeto literal"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"4d398db1-d160-433f-b5dc-07134ceb5b92","leftValue":"={{ $json.propertyName?.toBoolean() ?? false}}","rightValue":"","operator":{"type":"boolean","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-1472,1664],"id":"4af0b32a-e3dd-4581-b080-1c88ebd132d4","name":"Se tiver resumo"},{"parameters":{"operation":"get","key":"={{ $('Cria cache key').item.json.cache_key }}","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[-1680,1664],"id":"11786590-bfe8-4914-a1dd-328456b52066","name":"Busca resumo no cache","credentials":{"redis":{"id":"6zkVquzWhiKtaU5H","name":"Redis account"}}},{"parameters":{"schemaType":"manual","inputSchema":"{\n  \"type\": \"object\",\n  \"title\": \"ConversationAnalysisOutput\",\n  \"additionalProperties\": false,\n  \"required\": [\"analysis\"],\n  \"properties\": {\n    \"analysis\": {\n      \"type\": \"object\",\n      \"additionalProperties\": false,\n      \"required\": [\"summary\", \"tone\", \"needs\", \"lastObjective\", \"resolved\"],\n      \"properties\": {\n        \"summary\": {\n          \"type\": \"string\",\n          \"description\": \"Resumo conciso da conversa, destacando desejos, contexto e pontos-chave. Sem markdown.\"\n        },\n        \"tone\": {\n          \"type\": \"string\",\n          \"description\": \"Tom identificado na conversa (ex: irritado, neutro, satisfeito, confuso, sol√≠cito, entusiasmado, frustrado).\"\n        },\n        \"needs\": {\n          \"type\": \"array\",\n          \"description\": \"Lista dos principais desejos ou necessidades do cliente em frases curtas.\",\n          \"items\": {\n            \"type\": \"string\"\n          }\n        },\n        \"lastObjective\": {\n          \"type\": \"string\",\n          \"description\": \"√öltimo objetivo ou a√ß√£o solicitada pelo cliente, de forma resumida e direta.\"\n        },\n        \"resolved\": {\n          \"type\": \"boolean\",\n          \"description\": \"Indica se o √∫ltimo problema ou objetivo do cliente foi resolvido (true ou false).\"\n        }\n      }\n    }\n  }\n}\n"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[-1056,1872],"id":"0739178e-e891-4ee7-bc78-bb5cb23183c7","name":"Structured Output Parser"},{"parameters":{"model":{"__rl":true,"value":"gpt-4o-mini","mode":"list","cachedResultName":"gpt-4o-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-1296,1872],"id":"d4c3fd05-ecc6-4a17-bb66-e387ad0e80d3","name":"OpenAI Chat Model1","credentials":{"openAiApi":{"id":"weD4ayyAuWgClQqA","name":"OpenAi account"}}},{"parameters":{"promptType":"define","text":"=Voc√™ √© um analista especializado em interpretar conversas de pr√©-qualifica√ß√£o de leads.  \nEntenda de forma clara o perfil e o interesse do lead, sem inventar informa√ß√µes.  \nCom base nas mensagens abaixo, produza um resumo anal√≠tico e objetivo que identifique:\n\n1. O **tom da conversa** (ex: interessado, indeciso, confuso, apressado, desinteressado etc.)\n2. O **n√≠vel de interesse e maturidade do lead** (ex: apenas curioso, avaliando op√ß√µes, pronto para comprar)\n3. As **principais dores, objetivos ou necessidades mencionadas**\n4. O **produto ou solu√ß√£o de interesse** (ex: CRM, Apre.Chat, ApBank, etc.)\n5. O **pr√≥ximo passo sugerido ou solicitado** (ex: agendar demonstra√ß√£o, receber proposta, pedir mais informa√ß√µes)\n\nEst√°gios a serem seguidos:\n\nLegenda das mensagens:  \n- `r`: papel (`\"u\"` = lead, `\"a\"` = agente)  \n- `t`: texto limpo (sem markdown)  \n- `ts`: timestamp ISO local  \n\nMensagens recentes:  \n{{ $('Compacta as √∫ltimas mensagens').item.json.lastMessageCompact }}\n\nResumo da √∫ltima mensagem enviada pelo lead:  \n{{ $('Compacta as √∫ltimas mensagens').item.json.chatInput }}\n","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.2,"position":[-1232,1664],"id":"13443d0a-847d-4306-8abf-7d6896e88f3f","name":"AI - Gerar resumo das mensagens"},{"parameters":{"model":{"__rl":true,"value":"gpt-4o-mini","mode":"list","cachedResultName":"gpt-4o-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-2400,1904],"id":"8d377a0c-3e98-4a45-b3d6-663020525a8e","name":"OpenAI Chat Model2","credentials":{"openAiApi":{"id":"weD4ayyAuWgClQqA","name":"OpenAi account"}}},{"parameters":{"promptType":"define","text":"=Voc√™ √© um analista especializado em interpretar conversas de pr√©-qualifica√ß√£o de leads.  \nEntenda de forma clara o perfil e o interesse do lead, sem inventar informa√ß√µes.  \nCom base nas mensagens abaixo, produza um resumo anal√≠tico e objetivo que identifique:\n\n1. O **tom da conversa** (ex: interessado, indeciso, confuso, apressado, desinteressado etc.)\n2. O **n√≠vel de interesse e maturidade do lead** (ex: apenas curioso, avaliando op√ß√µes, pronto para comprar)\n3. As **principais dores, objetivos ou necessidades mencionadas**\n4. O **produto ou solu√ß√£o de interesse** (ex: CRM, Apre.Chat, ApBank, etc.)\n5. O **pr√≥ximo passo sugerido ou solicitado** (ex: agendar demonstra√ß√£o, receber proposta, pedir mais informa√ß√µes)\n\n√öltimo resumo gerado:\n{{ JSON.stringify($('Transforma resumo em objeto literal').first().json.output) }}\n\nResumo da √∫ltima mensagem enviada pelo cliente:\n{{ $('Transforma resumo em objeto literal').first().json.chatInput }}\n\nResposta gerada pelo Agente de IA:\n{{ $('AI Agent').first().json.output }}\n","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.2,"position":[-2352,1664],"id":"a6d41aa3-304e-474e-8242-5b09cfaa7c9f","name":"AI - Atualizar resumo"},{"parameters":{"schemaType":"manual","inputSchema":"{\n  \"type\": \"object\",\n  \"title\": \"ConversationAnalysisOutput\",\n  \"additionalProperties\": false,\n  \"required\": [\"analysis\"],\n  \"properties\": {\n    \"analysis\": {\n      \"type\": \"object\",\n      \"additionalProperties\": false,\n      \"required\": [\"summary\", \"tone\", \"needs\", \"lastObjective\", \"resolved\"],\n      \"properties\": {\n        \"summary\": {\n          \"type\": \"string\",\n          \"description\": \"Resumo conciso da conversa, destacando desejos, contexto e pontos-chave. Sem markdown.\"\n        },\n        \"tone\": {\n          \"type\": \"string\",\n          \"description\": \"Tom identificado na conversa (ex: irritado, neutro, satisfeito, confuso, sol√≠cito, entusiasmado, frustrado).\"\n        },\n        \"needs\": {\n          \"type\": \"array\",\n          \"description\": \"Lista dos principais desejos ou necessidades do cliente em frases curtas.\",\n          \"items\": {\n            \"type\": \"string\"\n          }\n        },\n        \"lastObjective\": {\n          \"type\": \"string\",\n          \"description\": \"√öltimo objetivo ou a√ß√£o solicitada pelo cliente, de forma resumida e direta.\"\n        },\n        \"resolved\": {\n          \"type\": \"boolean\",\n          \"description\": \"Indica se o √∫ltimo problema ou objetivo do cliente foi resolvido (true ou false).\"\n        }\n      }\n    }\n  }\n}\n"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[-2208,1872],"id":"43d9fe89-d74e-43a2-ae45-cf3144c476c7","name":"Structured Output Parser1"},{"parameters":{"operation":"set","key":"=chat_summary_{{ $('Webhook').item.json.body.contact.number }}_{{ $('Webhook').item.json.body.whatsappId }}_10","value":"={{ JSON.stringify($json.output) }}"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[-2016,1664],"id":"07c573b2-0634-460a-9a1f-d0d11788de31","name":"Salva resumo em cache","credentials":{"redis":{"id":"6zkVquzWhiKtaU5H","name":"Redis account"}}},{"parameters":{"description":"=Sempre que o usu√°rio enviar uma mensagem, siga **esta ordem**:\n\n## Input esperado (RIGOROSO):\n{\n  \"nome_do_campo\": \"valor_do_campo\"\n}\n\n1) Analise a mensagem e verifique se cont√©m valores correspondentes a alguma vari√°vel em:\n{{ JSON.stringify($('Seta vari√°veis da conversa').first().json.data) }}\n\n2) Para cada vari√°vel encontrada:\n   - Extraia somente o valor.\n   - Normalize quando necess√°rio:\n        ‚Ä¢ Se houver faixas (ex.: ‚Äú6 a 10‚Äù), mantenha o texto da faixa.\n        ‚Ä¢ Se o valor for booleano, interprete a partir do contexto (ex.: ‚Äún√£o trabalho com imobili√°ria‚Äù ‚Üí false).\n        ‚Ä¢ Se tiver m√∫ltiplos valores (type: string[]), armazene como lista.\n   - Se n√£o tiver certeza, **n√£o atualize**. Ao inv√©s disso, fa√ßa uma pergunta direta no pr√≥ximo turno para confirmar.\n\n3) Para **cada** vari√°vel identificada:\n   **Execute a tool **Atualizar param√™tros** imediatamente antes de responder, seguindo **exatamente** o formato:\n   { \"name\": \"<nome_da_variavel>\", \"value\": \"<valor_obtido>\" }\n\n   - Uma chamada separada para **cada** vari√°vel encontrada na mensagem.\n   - N√£o agrupe vari√°veis em uma √∫nica chamada.\n\n4) Depois de executar todas as tool calls necess√°rias:\n   - Continue a conversa normalmente conforme o fluxo.\n   - **Nunca informe ao usu√°rio que est√° atualizando vari√°veis.**\n   - **Nunca descreva sua l√≥gica interna.**\n\n5) Caso o usu√°rio forne√ßa uma informa√ß√£o que **corrige** uma vari√°vel j√° preenchida:\n   - Atualize novamente a vari√°vel usando a tool da mesma forma.\n","jsCode":"const stages = $('Seta est√°gios').first().json\nconst vars = $('Seta vari√°veis da conversa').item.json.data\n\nconst data = {\n  \"name\": Object.keys(typeof query == 'object' ? query : JSON.parse(query || \"{}\"))[0], \n  \"value\": Object.values(typeof query == 'object' ? query : JSON.parse(query || \"{}\"))[0]\n}\n\nObject.keys(stages).forEach(stageName => {\n  stages[stageName].actions.requiredDataForExecute = stages[stageName].actions.requiredDataForExecute.map(r => {\n    if (r.name == data.name) {\n      return {\n        ...r, \n        value: data.value\n      }\n    }\n\n\n    return r\n  })\n})\n\nif (vars[data.name]) {\n  vars[data.name].value = query\n}\n\nreturn JSON.stringify(data)"},"type":"@n8n/n8n-nodes-langchain.toolCode","typeVersion":1.3,"position":[2608,800],"id":"5322e98c-bbb4-49ea-8abd-53c7258771ff","name":"Atualizar param√™tros"},{"parameters":{"jsCode":"const cacheVars = $('Busca vari√°veis').first().json.propertyName ? JSON.parse($('Busca vari√°veis').first().json.propertyName) : undefined\n\nreturn cacheVars ?? {\n  data: {\n    name: {\n      description:\n        \"Se apresente e pergunte o *Nome do usu√°rio*. Pergunte de forma educada e respeitosa.\",\n      type: \"string\",\n    },\n    email: {\n      description:\n        \"Email do usu√°rio para entrar em contato quando houver a necessidade.\",\n      type: \"email\",\n    },\n    customerNeed: {\n      description:\n        \"Show, [NOME DO LEAD]! E hoje, o que mais tem te incomodado ou sentido falta a√≠ na sua \\nimobili√°ria? \\nMuitas vezes ouvimos problemas como sistemas com erros, lentid√£o, suporte demorado, ou at√© dificuldade pra fazer cobran√ßas e relat√≥rios... Mas quero entender no seu caso: o que voc√™ tem sentido falta ou gostaria de melhorar no seu processo de loca√ß√£o, vendas ou atendimento?\",\n      type: \"string[]\",\n    },\n    teamSize: {\n      description:\n        \"E s√≥ pra eu entender melhor quantas pessoas trabalham com voc√™? \\n\\nN√£o mostre as op√ß√µes, deixe aberto para o lead responder , interaja com o lead at√© que ele responda com uma das op√ß√µes abaixo: \\n\\nCorretor Aut√¥nomo \\n2 a 5 \\n6 a 10 \\n11 a 25 \\nMais de 25\",\n      type: \"string\",\n    },\n    numberOfBuildings: {\n      description:\n        \"Quantidade total de im√≥veis na carteira (para venda e loca√ß√£o) voc√™ tem dispon√≠veis para neg√≥cio, (sem considerar os locados ou vendidos) \\n\\nBusque por um n√∫mero \",\n      type: \"number\",\n    },\n    rentalTransferMode: {\n      description:\n        'Caso o lead N√ÉO trabalhe com loca√ß√µes, defina \"N√£o Utiliza\" e n√£o fa√ßa a pergunta! \\n\\n\\nE hoje, como voc√™s fazem as repasse dos valores dos alugu√©is para o propriet√°rio? \\n\\nN√£o mostre as op√ß√µes, deixe aberto para o lead responder , interaja com o lead at√© que ele responda com uma das op√ß√µes abaixo: \\n \\nManual em Dinheiro \\nManualmente via PIX \\nRemessa e Retorno Banc√°rio \\nRepasse Autom√°tico via outro Sistema Imobili√°rio',\n      type: \"string\",\n    },\n    fiscalNote: {\n      description:\n        \"Voc√™ gera notas fiscais para os contratos administrados pela sua imobili√°ria? Se sim, como √© feito o processo de gera√ß√£o dessas notas? Al√©m disso, voc√™ realiza o envio do DIMOB?\",\n      type: \"string\",\n    },\n    workWithRent: {\n      description:\n        \"Hoje voc√™s fazem gest√£o de contratos de loca√ß√£o? Se sim, mais ou menos quantos contratos voc√™s t√™m ativos?\\n\\nN√£o mostre as op√ß√µes, deixe aberto para o lead responder , interaja com o lead at√© que ele responda com uma das op√ß√µes abaixo:\\n\\nN√£o\\nAt√© 10 contratos  \\nDe 10 a 25 contratos  \\nDe 25 a 50 contratos  \\nDe 50 a 100 contratos  \\nDe 100 a 200 contratos  \\nDe 200 a 300 contratos  \\nDe 300 a 500 contratos  \\nMais de 500 contratos\",\n      type: \"string\",\n    },\n    amountInCurrentSystemOrBudget: {\n      description:\n        \"Pra entender se conseguimos te atender bem, quanto voc√™ estaria disposto a investir por m√™s em um sistema pra sua imobili√°ria? \\n(Se preferir, pode estimar um valor aproximado) \\n\\nN√£o mostre as op√ß√µes, deixe aberto para o lead responder , interaja com o lead at√© que ele responda com uma das op√ß√µes abaixo:\\n\\nN√£o quis informar  \\nat√© R$ 100  \\nat√© R$ 300  \\nat√© R$ 500  \\nat√© R$ 800  \\nat√© R$ 1.200  \\nat√© R$ 1.600,00  \\nmais de R$ 1.600,00\",\n      type: \"string\",\n    },\n    currentSystem: {\n      description:\n        \" \\nVoc√™ usa algum sistema hoje para gerenciar sua imobili√°ria? Se sim, qual deles? \\n \\nN√£o mostre as op√ß√µes, deixe aberto para o lead responder , interaja com o lead at√© que ele responda com uma das op√ß√µes abaixo: \\n \\nN√£o Utiliza  \\nAlterdata \\nAlude \\nArbo \\nApp Facilita \\nCasaSoft \\nCode 49 \\nImoAlert \\nImobzi \\nImobia \\nImobi Brasil \\nImopro \\niValue \\nJetImob \\nKenlo \\nMicrosistec \\nNido \\nKurole \\nSigasoft \\nUniversal Imoview \\nVista \\nWideSys \\nSami Sistemas \\nSuperL√≥gica \\nSi9 Sistemas \\nSistema Pr√≥prio \\nSite Pr√≥prio \\nProperfy\",\n      type: \"string\",\n    },\n    rentalChargeMode: {\n      description:\n        ' \\nCaso o lead N√ÉO trabalhe com loca√ß√µes, defina \"N√£o Utiliza\" e n√£o fa√ßa a pergunta! \\n \\nE hoje, como voc√™s fazem as cobran√ßas dos alugu√©is? \\n \\nN√£o mostre as op√ß√µes, deixe aberto para o lead responder , interaja com o lead at√© que ele responda com uma das op√ß√µes abaixo: \\n \\nManual/Dinheiro   \\nPIX   \\nTED   \\nBoleto   \\nBoleto - Autom√°tico',\n      type: \"string\",\n    },\n    isRealEstate: {\n      description:\n        ' \\nPergunte qual cargo o lead ocupa no mercado imobili√°rio (ex: \"Qual sua fun√ß√£o na imobili√°ria?\").  \\n \\nS√≥cio / Diretor \\nPropriet√°rio \\nCorretor de Im√≥veis \\nGerente de Vendas \\nGerente de Alugu√©is \\nAuxiliar Administrativo \\nEstagi√°rio \\nMarketing \\nOutro Cargo na imobili√°ria \\nou \"N√£o trabalho no setor\" \\n \\nSe n√£o trabalhar no setor, agrade√ßa e encerre educadamente.',\n      type: \"string\",\n    },\n    qualificationCompleted: {\n      description:\n        \"Marque como true quando o usu√°rio responder a √∫ltima pergunta de qualifica√ß√£o (or√ßamento mensal para a vari√°vel amountInCurrentSystemOrBudget)\",\n      type: \"boolean\",\n    },\n    presentationHasSent: {\n      description:\n        \"Marque como true quando a apresenta√ß√£o em PDF for enviada ao cliente. IMPORTANTE: Sempre defina como true ap√≥s enviar a apresenta√ß√£o para evitar envios duplicados\",\n      type: \"boolean\",\n    },\n  },\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[832,384],"id":"02a38686-3fa9-4379-93b1-afb5cf1dbcd4","name":"Seta vari√°veis da conversa"},{"parameters":{"jsCode":"return {\n  agentName: \"Alicia\",\n  internalName: \"Alicia da Apresenta.me\",\n  initialMessage: \"Ol√°, tudo bem? üëã \\n\\nEu sou a Alicia, assistente da Apresenta.me, vou te ajudar entendendo melhor sua necessidade.\",\n  language: \"pt-BR\",\n  timeZone: \"Sao Paulo (GTM -3)\",\n  role: \"SDR S√™nior\",\n  companyName: \"Apresenta.me\",\n  companyDepartment: \"Software\",\n  companySite: \"https://apresenta.me\",\n  conduct: \" \\n### SOBRE SEU PAPEL \\n- Voc√™ √© um SDR, sua Principal fun√ß√£o √© qualificar o lead. para entender se ele tem as caracter√≠sticas do nosso ICP; \\n- Voc√™ ir√° apresentar o sistema da Apresenta.me (https://apresenta.me), um software SAAS para gest√£o completa de imobili√°rias. \\n- Comporte-se exatamente como um representante da empresa, sendo cordial e profissional. \\n \\n \\n### SEU TOM DE VOZ \\n- Responda de maneira simples e objetiva e profissional; \\n- Responda por padr√£o at√© 130 caracteres. S√≥ aumente a resposta quando for estritamente necess√°rio; \\n- Seja emp√°tico e consultivo, nunca agressivo ou invasivo; \\n- Responda com o mesmo tom de voz que o Lead estiver; \\n- Se necess√°rio, utilize emojis como üòÑüëçüè¢üîëüìãüöÄü•≥üå±ü§© etc. \\n- O nome correto do sistema √© Apresenta.me (com ponto), mas fale Apresentame sem pausas; \\n \\n### REGRAS ESPEC√çFICAS \\n- Quando for informar uma URL, informe EXATAMENTE a URL dispon√≠vel \\n- NUNCA fale dos concorrentes de forma negativa \\n- NUNCA saia do personagem \\n- Fa√ßa APENAS UMA pergunta por vez para n√£o sobrecarregar o lead \\n- NUNCA convide para um agendamento de demonstra√ß√£o antes de passar pelo est√°gio de Qualifica√ß√£o \\n- NUNCA direcione para nenhum contato ou link sem antes efetuar a qualifica√ß√£o do lead\"\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1040,384],"id":"bbbbe000-37d3-4957-b3cd-57a2ac649199","name":"Seta perfil"},{"parameters":{"jsCode":"const cacheStages = $('Busca est√°gios').first().json.propertyName ? JSON.parse($('Busca est√°gios').first().json.propertyName) : undefined\nconst vars = $('Seta vari√°veis da conversa').first().json.data\n\nfunction findVarInstruction(varName){\n    return vars[varName].description\n}\n\nconst stages = cacheStages ?? {\n  \"Identificar o usuario\": {\n    sortNumber: 1,\n    conditionPrompt: \"Se √© in√≠cio da conversa ou se o usu√°rio ainda n√£o informou o nome dele\",\n    requiredDataForExecute: null,\n    actions: {\n      requiredDataForExecute: [\n        {\n          name: \"name\",\n          value: null\n        }\n      ],\n      actions: null, \n      finalInstructions: \"Agrade√ßa e siga para o pr√≥ximo est√°gio\"\n    }\n  },\n  \"Verificar se trabalha no mercado imobili√°rio\": {\n    sortNumber: \"4\",\n    conditionPrompt: \"Se ja respondeu o nome.\",\n    requiredDataForExecute: null,\n    actions: {\n      requiredDataForExecute: [\n        {\n          name: \"isRealEstate\",\n          value: null\n        }\n      ],\n      actions: null,\n      finalInstructions: \"Perguntar se o lead trabalha no mercado imobili√°rio \\n- Se n√£o trabalhar, retorne para o lead que a Apresenta.me apenas atende pessoas que trabalhem com o mercado imobili√°rio, agrade√ßa pelo interesse e encerre o atendimento educadamente\"\n    }\n  },\n  \"Diagnosticar a necessidade\": {\n    sortNumber: \"3\",\n    conditionPrompt: \"Se voc√™ j√° sabe o nome do lead , e ainda n√£o definiu suas dores, pergunte sobre quais os problemas ele enfrenta e que a Apresenta.me pode ajudar.\",\n    requiredDataForExecute: [\n      {\n        name: \"isRealEstate\", \n        operator: \"exist\",\n        value: null\n      }\n    ],\n    actions: {\n      requiredDataForExecute: [\n        {\n          name: \"customerNeed\",\n          value: null\n        }\n      ],\n      actions: null,\n      finalInstructions: \" \\nAfunile na necessidade espec√≠fica dele, garantindo que voc√™ saiba qual √© a necessidade espec√≠fica que ele tem.  \\n \\nFa√ßa isso atrav√©s de pergunta. Exemplo, se o usu√°rio quer saber sobre algo que possui ramifica√ß√µes nas informa√ß√µes dispon√≠veis, fa√ßa uma pergunta, e se poss√≠vel liste as ramifica√ß√µes / op√ß√µes existentes, para voc√™ saber exatamente onde que o usu√°rio est√° com d√∫vidas, e principalmente quais as d√∫vidas que ele tem quanto ao software da Apresenta.me\"\n    }\n  }, \n  \"Qualificacao\": {\n    sortNumber: \"4\",\n    conditionPrompt: \"Se voc√™ j√° sabe o nome do lead, se ele trabalha no mercado imobili√°rio e se voc√™ j√° sabe as necessidades do lead mas ainda n√£o aprondou-se em tais necessidades.\",\n    requiredDataForExecute: [\n      {\n        name: \"isRealEstate\", \n        operator: \"exist\",\n        value: null\n      }\n    ],\n    actions: {\n      requiredDataForExecute: [\n        {\n          name: \"teamSize\",\n          value: null\n        }, \n        {\n          name: \"workWithRent\",\n          value: null\n        },  \n        {\n          name: \"numberOfBuildings\",\n          value: null\n        },\n        {\n          name: \"currentSystem\",\n          value: null\n        },\n        {\n          name: \"rentalTransferMode\",\n          value: null\n        },\n        {\n          name: \"amountInCurrentSystemOrBudget\",\n          value: null\n        },\n        {\n          name: \"qualificationCompleted\",\n          value: null\n        }\n      ],\n      actions: null,\n      finalInstructions: \"\"\n    }\n  },  \n  \"Enviar Apresentacao em PDF\": {\n    sortNumber: \"5\",\n    conditionPrompt: \"Caso o processo de qualifica√ß√£o esteja finalizado\",\n    requiredDataForExecute: [\n      {\n        name: \"qualificationCompleted\", \n        operator: \"=\",\n        value: true\n      },\n      {\n        name: \"presentationHasSent\", \n        operator: \"!exist\",\n        value: null\n      }\n    ],\n    actions: {\n      requiredDataForExecute: [\n        {\n          name: \"teamSize\",\n          value: null\n        }\n      ],\n      actions: null,\n      finalInstructions: \"\"\n    }\n  }  \n}\n\n// Iterar sobre todos os stages\nObject.keys(stages).forEach(stageKey => {\n  const stage = stages[stageKey];\n  \n  // Verificar se existe actions e requiredDataForExecute\n  if (stage.actions && stage.actions.requiredDataForExecute) {\n    // Iterar sobre cada item de requiredDataForExecute\n    stage.actions.requiredDataForExecute.forEach(item => {\n      // Adicionar a propriedade instructions\n      item.instruction = findVarInstruction(item.name);\n    });\n  }\n});\n\nreturn stages;"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1248,384],"id":"d21ae8ce-7398-4003-a82a-5bcb129b4592","name":"Seta est√°gios"},{"parameters":{"mode":"raw","jsonOutput":"={\n  \"cache_key\": \"sdr_{{ $('Webhook').item.json.body.ticketId }}_chat_summary_{{ $('Webhook').item.json.body.contact.number }}_{{ $('Webhook').item.json.body.whatsappId }}_10\"\n} ","options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[224,384],"id":"5216ce5c-d749-4c08-a466-e42cb1bfb985","name":"Cria cache key"},{"parameters":{"operation":"get","key":"={{ $json.cache_key }}_stages","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[432,384],"id":"4431ab91-126b-47b2-8917-557a348322ca","name":"Busca est√°gios","credentials":{"redis":{"id":"6zkVquzWhiKtaU5H","name":"Redis account"}}},{"parameters":{"operation":"get","key":"={{ $('Cria cache key').item.json.cache_key }}_vars","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[640,384],"id":"c01a8e81-2a8c-4bfd-b7ad-f8fc2940be9b","name":"Busca vari√°veis","credentials":{"redis":{"id":"6zkVquzWhiKtaU5H","name":"Redis account"}}},{"parameters":{"jsCode":"return {\n  chatInput: $('Webhook').first().json.body.message\n}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1856,384],"id":"f6afd191-56f5-409b-b85d-3cc39703d1c2","name":"Retorna chatInput"},{"parameters":{"operation":"delete","key":"={{ $json.cache_key }}_stages"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[432,576],"id":"73a9a621-de0b-460b-8d83-31f27002cfe0","name":"Deleta cache estagios","credentials":{"redis":{"id":"6zkVquzWhiKtaU5H","name":"Redis account"}},"disabled":true},{"parameters":{"operation":"delete","key":"={{ $('Cria cache key').item.json.cache_key }}_vars"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[640,576],"id":"b60e69a8-2b98-48ab-bb60-56a0a9991ad1","name":"Delete cache variaveis","credentials":{"redis":{"id":"6zkVquzWhiKtaU5H","name":"Redis account"}},"disabled":true},{"parameters":{"operation":"set","key":"={{ $('Cria cache key').first().json.cache_key }}_stages","value":"={{ JSON.stringify($('Seta est√°gios').item.json)}}"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[2672,384],"id":"9c2401d6-4caa-4249-b791-d3a0c1588329","name":"Seta cache dos estagios","credentials":{"redis":{"id":"6zkVquzWhiKtaU5H","name":"Redis account"}}},{"parameters":{"operation":"set","key":"={{ $('Cria cache key').item.json.cache_key }}_vars","value":"={{ JSON.stringify($('Seta vari√°veis da conversa').item.json)}}"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[2880,384],"id":"411b6839-21cf-4bdd-bed8-1762ee01b9ce","name":"Seta cache das variaveis","credentials":{"redis":{"id":"6zkVquzWhiKtaU5H","name":"Redis account"}}},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('Cria cache key').item.json.cache_key }}"},"type":"@n8n/n8n-nodes-langchain.memoryPostgresChat","typeVersion":1.3,"position":[2128,656],"id":"558085fb-8a72-49cc-9595-461d2f48f03c","name":"Postgres Chat Memory","credentials":{"postgres":{"id":"pXgXB3fm4CWNM9Pd","name":"Postgres account"}}},{"parameters":{"description":"Esta tool deve ser executada SEMPRE quando for identificada a qualifica√ß√£o do lead.\nEsta tool ir√° enviar a proposta comercial para o lead","workflowId":{"__rl":true,"value":"wd0uAb0Sm1fW5YNt","mode":"list","cachedResultUrl":"/workflow/wd0uAb0Sm1fW5YNt","cachedResultName":"Enviar proposta comercial"},"workflowInputs":{"mappingMode":"defineBelow","value":{"whatsappId":"={{ $('Webhook').item.json.body.whatsappId }}","messageRepliedId":"={{ $('Webhook').item.json.body.messageId }}","message":"Segue proposta comercial üöÄüöÄ","number":"={{ $('Webhook').item.json.body.contact.number }}","addUserName":"={{ $('Seta perfil').item.json.agentName }}","company":10},"matchingColumns":[],"schema":[{"id":"message","displayName":"message","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"number","displayName":"number","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"addUserName","displayName":"addUserName","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"whatsappId","displayName":"whatsappId","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"number","removed":false},{"id":"messageRepliedId","displayName":"messageRepliedId","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"number","removed":false},{"id":"company","displayName":"company","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"number","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[2240,800],"id":"a6b0be6e-0f6b-4fe9-b3d1-5c951c2558e6","name":"Enviar proposta comercial"},{"parameters":{"jsCode":"let stages = $('Seta est√°gios').first().json\n\nObject.entries(stages).forEach(([key, value]) => {\n  const newValue = {\n    s: value.sortNumber,\n    cp: value.conditionPrompt,\n    rd: value.requiredDataForExecute?.map(rd => ({\n      n: rd.name,\n      o: rd.operator, \n      v: rd.value\n    })),\n    a: value.actions?.requiredDataForExecute?.map(rd => ({\n      n: rd.name, \n      v: rd.value, \n      i: rd.instruction,\n      a: rd.actions\n    })) ?? null, \n    fi: value.finalInstructions\n  }\n  stages[key] = newValue \n})\n\nreturn {\n  stages\n}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1648,384],"id":"5b96eec8-f0b4-46ef-b5f4-da4845346a01","name":"Compacta JSON est√°gios"},{"parameters":{"jsCode":"return {\n  legend: {\n    \"<EST√ÅGIO>\": {\n      s: \"sortNumber: ordem de execu√ß√£o do est√°gio\",\n      cp: \"conditionPrompt: condi√ß√£o para considerar este est√°gio apto para execu√ß√£o\",\n      rd: \"requiredDataForExecute (n√≠vel do est√°gio): lista de condi√ß√µes para habilitar o est√°gio para execu√ß√£o; null se n√£o houver\",\n      a: {\n         rd: \"requiredDataForExecute: lista de vari√°veis que devem ser solicitados nesste est√°gio\",\n         a: \"actions: reservado para a√ß√µes que devem ser executadas ap√≥s a coleta das vari√°veis\", \n        fi: \"finalInstructions: instru√ß√£o a executar ao concluir o est√°gio\",\n        _rd_item: {\n          n: \"name: nome da vari√°vel a coletar\",\n          v: \"value: valor atual/padr√£o da vari√°vel; pode ser null\",\n          i: \"instruction: pergunta/guia para capturar a vari√°vel\",\n        }\n      },\n    },\n    _rd_item: {\n      n: \"nome da vari√°vel verificada na condi√ß√£o do est√°gio\",\n      o:\n        \"operador de verifica√ß√£o: 'exist', '!exist', '=' entre outros\",\n      v:\n        \"valor esperado quando operator='='; null para outros casos\",\n    },\n  },\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1456,384],"id":"f743dd40-2875-4151-9bbb-e4b91b19b0b2","name":"Retorna legenda dos est√°gios"}],"connections":{"Embeddings OpenAI":{"ai_embedding":[[{"node":"Busca informa√ß√µes do banco de dados","type":"ai_embedding","index":0}]]},"AI Agent":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"Busca informa√ß√µes do banco de dados":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Retorna message":{"main":[[{"node":"Compacta as √∫ltimas mensagens","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"Seta cache dos estagios","type":"main","index":0}]]},"Compacta as √∫ltimas mensagens":{"main":[[{"node":"Cria cache key","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Webhook":{"main":[[{"node":"Retorna message","type":"main","index":0}]]},"Se tiver resumo":{"main":[[{"node":"Transforma resumo em objeto literal","type":"main","index":0}],[{"node":"AI - Gerar resumo das mensagens","type":"main","index":0}]]},"Busca resumo no cache":{"main":[[{"node":"Se tiver resumo","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"AI - Gerar resumo das mensagens","type":"ai_outputParser","index":0}]]},"OpenAI Chat Model1":{"ai_languageModel":[[{"node":"AI - Gerar resumo das mensagens","type":"ai_languageModel","index":0}]]},"AI - Gerar resumo das mensagens":{"main":[[{"node":"Transforma resumo em objeto literal","type":"main","index":0}]]},"OpenAI Chat Model2":{"ai_languageModel":[[{"node":"AI - Atualizar resumo","type":"ai_languageModel","index":0}]]},"AI - Atualizar resumo":{"main":[[{"node":"Salva resumo em cache","type":"main","index":0}]]},"Structured Output Parser1":{"ai_outputParser":[[{"node":"AI - Atualizar resumo","type":"ai_outputParser","index":0}]]},"Atualizar param√™tros":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Seta vari√°veis da conversa":{"main":[[{"node":"Seta perfil","type":"main","index":0}]]},"Seta perfil":{"main":[[{"node":"Seta est√°gios","type":"main","index":0}]]},"Seta est√°gios":{"main":[[{"node":"Retorna legenda dos est√°gios","type":"main","index":0}]]},"Cria cache key":{"main":[[{"node":"Busca est√°gios","type":"main","index":0},{"node":"Deleta cache estagios","type":"main","index":0}]]},"Busca est√°gios":{"main":[[{"node":"Busca vari√°veis","type":"main","index":0}]]},"Busca vari√°veis":{"main":[[{"node":"Seta vari√°veis da conversa","type":"main","index":0}]]},"Retorna chatInput":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Deleta cache estagios":{"main":[[{"node":"Delete cache variaveis","type":"main","index":0}]]},"Seta cache dos estagios":{"main":[[{"node":"Seta cache das variaveis","type":"main","index":0}]]},"Postgres Chat Memory":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"Enviar proposta comercial":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Compacta JSON est√°gios":{"main":[[{"node":"Retorna chatInput","type":"main","index":0}]]},"Retorna legenda dos est√°gios":{"main":[[{"node":"Compacta JSON est√°gios","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"Webhook":[{"json":{"headers":{"host":"n8n.apresenta.me","x-real-ip":"172.68.191.167","x-real-port":"20184","x-forwarded-for":"186.227.138.107, 172.68.191.167","x-forwarded-proto":"http","x-forwarded-host":"n8n.apresenta.me","x-forwarded-port":"80","remote-host":"172.68.191.167","connection":"close","content-length":"38628","accept":"application/json, text/plain, */*","accept-encoding":"gzip, br","user-agent":"axios/1.12.2","cf-ray":"99d0b4bb3e0f0cad-NVT","content-type":"application/json","cdn-loop":"cloudflare; loops=1","cf-connecting-ip":"186.227.138.107","cf-ipcountry":"BR","cf-visitor":"{\"scheme\":\"https\"}"},"params":{},"query":{},"body":{"message":"Usu√°rio enviou um √°udio com a seguinte transcri√ß√£o: `Boa tarde, meu nome √© Jo√£o Vitor.`\n\n","messageId":"2920941","contact":{"id":"34529","name":"554788950332","number":"554788950332","profilePicUrl":"https://pps.whatsapp.net/v/t61.24694-24/425105449_1361615211300388_1143514098522857072_n.jpg?ccb=11-4&oh=01_Q5Aa3AHwIxDaX1qAPn6f1bP30_dPNLub5ezXK1uoWsqk-vn8RQ&oe=6920C0A3&_nc_sid=5e03e0&_nc_cat=102","createdAt":"2025-08-26T13:37:58.507-03:00","updatedAt":"2025-11-11T17:57:59.664-03:00","email":"","isGroup":false,"companyId":"10","whatsappId":"6","onlyResponsible":false,"userId":"1","aprePersonId":null,"apreDealId":null,"meta":{"ignoreCheck":true,"ignorePermission":true,"dontSendSocket":false}},"whatsappId":"6","companyId":10,"lastMessages":"[{\"body\":\"_dev-joaor_\\n*Alicia:*\\n√ìtimo, Jo√£o Vitor! Como propriet√°rio, quais s√£o os principais problemas que voc√™ enfrenta na sua imobili√°ria?\",\"messageType\":\"conversation\",\"createdAt\":\"2025-11-10T17:24:11.000-03:00\",\"updatedAt\":\"2025-11-10T17:24:14.351-03:00\",\"dataJson\":{\"key\":{\"id\":\"3EB0338A68F9715D90865D4A55B06CD2476BD4F9\",\"fromMe\":true,\"remoteJid\":\"554788950332@s.whatsapp.net\"},\"source\":\"unknown\",\"status\":\"PENDING\",\"message\":{\"conversation\":\"_dev-joaor_\\n*Alicia:*\\n√ìtimo, Jo√£o Vitor! Como propriet√°rio, quais s√£o os principais problemas que voc√™ enfrenta na sua imobili√°ria?\"},\"pushName\":\"Voc√™\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"conversation\",\"messageTimestamp\":1762806251},\"id\":\"2920920\",\"mediaPath\":null,\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":true,\"summary\":null,\"file\":null,\"mediaUrl\":null,\"meta\":{}},{\"body\":\"\",\"messageType\":\"audio\",\"createdAt\":\"2025-11-10T17:26:21.000-03:00\",\"updatedAt\":\"2025-11-10T17:26:31.921-03:00\",\"dataJson\":{\"key\":{\"id\":\"3A31C9C63101B90BF31A\",\"fromMe\":false,\"remoteJid\":\"554788950332@s.whatsapp.net\",\"senderLid\":\"66237388329068@lid\"},\"source\":\"ios\",\"status\":\"DELIVERY_ACK\",\"message\":{\"audioMessage\":{\"ptt\":true,\"url\":\"https://mmg.whatsapp.net/v/t62.7117-24/542294922_1381308666878110_285027237682323095_n.enc?ccb=11-4&oh=01_Q5Aa3AFyopT-z_y1ACJbebFw9xJUug6VC4Ykqevo6pLbaUEHtg&oe=6939BEC5&_nc_sid=5e03e0&mms3=true\",\"seconds\":3,\"mediaKey\":\"SirqGklZ7jiTulDEnmYledEyPXJSMB+3fgdELhQ/Wbk=\",\"mimetype\":\"audio/ogg; codecs=opus\",\"waveform\":\"AQIEBgUFBQUFBQcJDAwMDAsLCwoJCSdFZGRkZFtSSj80KiUhHBsZFxQSEA8ODQ0PEBIVGRYTEQ8ODQsKCSdFZA==\",\"directPath\":\"/v/t62.7117-24/542294922_1381308666878110_285027237682323095_n.enc?ccb=11-4&oh=01_Q5Aa3AFyopT-z_y1ACJbebFw9xJUug6VC4Ykqevo6pLbaUEHtg&oe=6939BEC5&_nc_sid=5e03e0\",\"fileLength\":\"7254\",\"fileSha256\":\"yoOxQplz+Z7N3pK99dyFrpAx0jdhj8VK7/9hC8E6apM=\",\"fileEncSha256\":\"6rH7V1GJPYmA+UfjzsFg/tFZpWffy1fS0UgzOpWOFcI=\",\"streamingSidecar\":\"UZcZ6v+GBNSVFg==\",\"mediaKeyTimestamp\":\"1762806375\"},\"messageContextInfo\":{\"messageSecret\":\"Tg3Oq4V7SnMDgl5UDYhatXcVBIoIlmHdydQkNdncAy4=\",\"deviceListMetadata\":{\"senderKeyHash\":\"IJIgQVTRb/zQRg==\",\"senderTimestamp\":\"1762606390\",\"recipientKeyHash\":\"/HUR35w58nctUQ==\",\"recipientTimestamp\":\"1762517652\"},\"deviceListMetadataVersion\":2}},\"pushName\":\"Joaozinho\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"audioMessage\",\"messageTimestamp\":1762806381},\"id\":\"2920921\",\"mediaPath\":\"3A31C9C63101B90BF31A.mpga\",\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":false,\"summary\":\"Usu√°rio enviou um √°udio com a seguinte transcri√ß√£o: `Boa tarde.`\\n\\n\",\"file\":{\"id\":\"248718\",\"companyId\":\"10\",\"moduleType\":\"Message\",\"moduleId\":\"2920921\",\"collection\":\"file\",\"bucket\":\"ticket/110928/\",\"name\":\"a6f48f1b-2497-4ce8-8077-fef98b19abf2.mp3\",\"fileName\":\"3A31C9C63101B90BF31A\",\"version\":null,\"extension\":\"mpga\",\"mimeType\":\"audio/mpeg\",\"size\":\"79038\",\"createdAt\":\"2025-11-10T17:26:24.460-03:00\",\"updatedAt\":\"2025-11-10T17:26:24.460-03:00\",\"meta\":{}},\"mediaUrl\":\"https://grqgzepwdxag.compat.objectstorage.sa-saopaulo-1.oraclecloud.com/files.apre.chat/000010/ticket/110928/3A31C9C63101B90BF31A.mpga\",\"meta\":{}},{\"body\":\"_dev-joaor_\\n*Alicia:*\\nOl√°, tudo bem? üëã \\n\\nEu sou a Alicia, assistente da Apresenta.me, vou te ajudar entendendo melhor sua necessidade. \\n\\nQual √© o seu nome?\",\"messageType\":\"conversation\",\"createdAt\":\"2025-11-10T17:26:36.000-03:00\",\"updatedAt\":\"2025-11-10T17:26:39.253-03:00\",\"dataJson\":{\"key\":{\"id\":\"3EB0020ED9C9850A5E978FAFA921EEB8DD1F33AE\",\"fromMe\":true,\"remoteJid\":\"554788950332@s.whatsapp.net\"},\"source\":\"unknown\",\"status\":\"PENDING\",\"message\":{\"conversation\":\"_dev-joaor_\\n*Alicia:*\\nOl√°, tudo bem? üëã \\n\\nEu sou a Alicia, assistente da Apresenta.me, vou te ajudar entendendo melhor sua necessidade. \\n\\nQual √© o seu nome?\"},\"pushName\":\"Voc√™\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"conversation\",\"messageTimestamp\":1762806396},\"id\":\"2920922\",\"mediaPath\":null,\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":true,\"summary\":null,\"file\":null,\"mediaUrl\":null,\"meta\":{}},{\"body\":\"\",\"messageType\":\"audio\",\"createdAt\":\"2025-11-10T17:26:55.000-03:00\",\"updatedAt\":\"2025-11-10T17:27:05.260-03:00\",\"dataJson\":{\"key\":{\"id\":\"3A538BD9C758994F4E2A\",\"fromMe\":false,\"remoteJid\":\"554788950332@s.whatsapp.net\",\"senderLid\":\"66237388329068@lid\"},\"source\":\"ios\",\"status\":\"DELIVERY_ACK\",\"message\":{\"audioMessage\":{\"ptt\":true,\"url\":\"https://mmg.whatsapp.net/v/t62.7117-24/581119964_2014549916011464_3216410678065981189_n.enc?ccb=11-4&oh=01_Q5Aa3AHE2janzkj6HC1K0nxOhoSeR7hK2Z-VxlbKAX_UCkacjQ&oe=6939B45D&_nc_sid=5e03e0&mms3=true\",\"seconds\":3,\"mediaKey\":\"zfhxJlFhJwuErIDa+dywA9aZQBbEBiD2lhUxmdBGqWc=\",\"mimetype\":\"audio/ogg; codecs=opus\",\"waveform\":\"AAABAgMDAwMDAwMEBgcHBwcJCw0SFxwZFhMnQVtkZGRkZGRkZGRjYF1bXmBjYV9cUkU4LycgGhYTERQXGRcVEw==\",\"directPath\":\"/v/t62.7117-24/581119964_2014549916011464_3216410678065981189_n.enc?ccb=11-4&oh=01_Q5Aa3AHE2janzkj6HC1K0nxOhoSeR7hK2Z-VxlbKAX_UCkacjQ&oe=6939B45D&_nc_sid=5e03e0\",\"fileLength\":\"7305\",\"fileSha256\":\"sh8zMQQ1RDBZ1a+7t/pVeFuV8SY1J9d2uamGey4Ku2I=\",\"fileEncSha256\":\"F1eYgmK6dHHThHlukwsseJctcYMeFJMV78b5D1SAHDc=\",\"streamingSidecar\":\"ZRKPZn1H3DUwuw==\",\"mediaKeyTimestamp\":\"1762806410\"},\"messageContextInfo\":{\"messageSecret\":\"0ArHYSbGSE59woLAUnTZJS2tr8kgsdByPQIYi5o9vxA=\",\"deviceListMetadata\":{\"senderKeyHash\":\"IJIgQVTRb/zQRg==\",\"senderTimestamp\":\"1762606390\",\"recipientKeyHash\":\"/HUR35w58nctUQ==\",\"recipientTimestamp\":\"1762517652\"},\"deviceListMetadataVersion\":2}},\"pushName\":\"Joaozinho\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"audioMessage\",\"messageTimestamp\":1762806415},\"id\":\"2920923\",\"mediaPath\":\"3A538BD9C758994F4E2A.mpga\",\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":false,\"summary\":\"Usu√°rio enviou um √°udio com a seguinte transcri√ß√£o: `Jo√£o Vitor.`\\n\\n\",\"file\":{\"id\":\"248719\",\"companyId\":\"10\",\"moduleType\":\"Message\",\"moduleId\":\"2920923\",\"collection\":\"file\",\"bucket\":\"ticket/110928/\",\"name\":\"53aa82b4-7596-43c3-a2f4-bb9acb3ee5d2.mp3\",\"fileName\":\"3A538BD9C758994F4E2A\",\"version\":null,\"extension\":\"mpga\",\"mimeType\":\"audio/mpeg\",\"size\":\"76530\",\"createdAt\":\"2025-11-10T17:26:58.063-03:00\",\"updatedAt\":\"2025-11-10T17:26:58.063-03:00\",\"meta\":{}},\"mediaUrl\":\"https://grqgzepwdxag.compat.objectstorage.sa-saopaulo-1.oraclecloud.com/files.apre.chat/000010/ticket/110928/3A538BD9C758994F4E2A.mpga\",\"meta\":{}},{\"body\":\"_dev-joaor_\\n*Alicia:*\\nPrazer em conhecer, Jo√£o Vitor! üòä \\n\\nQual sua fun√ß√£o na imobili√°ria?\",\"messageType\":\"conversation\",\"createdAt\":\"2025-11-10T17:27:09.000-03:00\",\"updatedAt\":\"2025-11-10T17:27:12.596-03:00\",\"dataJson\":{\"key\":{\"id\":\"3EB0FFF2C2482BF5FDD14FA27FCDCB515FAD25AF\",\"fromMe\":true,\"remoteJid\":\"554788950332@s.whatsapp.net\"},\"source\":\"unknown\",\"status\":\"PENDING\",\"message\":{\"conversation\":\"_dev-joaor_\\n*Alicia:*\\nPrazer em conhecer, Jo√£o Vitor! üòä \\n\\nQual sua fun√ß√£o na imobili√°ria?\"},\"pushName\":\"Voc√™\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"conversation\",\"messageTimestamp\":1762806429},\"id\":\"2920924\",\"mediaPath\":null,\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":true,\"summary\":null,\"file\":null,\"mediaUrl\":null,\"meta\":{}},{\"body\":\"\",\"messageType\":\"audio\",\"createdAt\":\"2025-11-10T17:28:05.000-03:00\",\"updatedAt\":\"2025-11-10T17:28:14.421-03:00\",\"dataJson\":{\"key\":{\"id\":\"3AE6DD602382807606A0\",\"fromMe\":false,\"remoteJid\":\"554788950332@s.whatsapp.net\",\"senderLid\":\"66237388329068@lid\"},\"source\":\"ios\",\"status\":\"DELIVERY_ACK\",\"message\":{\"audioMessage\":{\"ptt\":true,\"url\":\"https://mmg.whatsapp.net/v/t62.7117-24/30924161_1497701864817064_1341121987959247729_n.enc?ccb=11-4&oh=01_Q5Aa3AGUfIthx22DriYiEA_DFwkc7iM0MQI5wZaO-obrSaYN7w&oe=6939BCBB&_nc_sid=5e03e0&mms3=true\",\"seconds\":3,\"mediaKey\":\"/dRoqhuQn7Oe2upYz7uciGXCJeJVZPEHWBpbFDcaOOw=\",\"mimetype\":\"audio/ogg; codecs=opus\",\"waveform\":\"AAABAgIDBQkNDw0LCwsLCw0OEhYaGhocNlBkZGRiXlpaXmJkZGReVk5AMiQeFxEOCwgHBgUEBAQGBwcGBgUEBA==\",\"directPath\":\"/v/t62.7117-24/30924161_1497701864817064_1341121987959247729_n.enc?ccb=11-4&oh=01_Q5Aa3AGUfIthx22DriYiEA_DFwkc7iM0MQI5wZaO-obrSaYN7w&oe=6939BCBB&_nc_sid=5e03e0\",\"fileLength\":\"7779\",\"fileSha256\":\"NSpl6tHurTmZ94wGsBpOF98NDZTJNOzgj61J1n1FERg=\",\"fileEncSha256\":\"Yg9yHwQUJID150tNlyRWZqZexmFwBgbHUlWyowWotPY=\",\"streamingSidecar\":\"jAaOnIisnDat3Q==\",\"mediaKeyTimestamp\":\"1762806479\"},\"messageContextInfo\":{\"messageSecret\":\"G6c81kPvPaGPq1gvFPb/EhUOYnRHhRT9S9j2EsN5p2A=\",\"deviceListMetadata\":{\"senderKeyHash\":\"IJIgQVTRb/zQRg==\",\"senderTimestamp\":\"1762606390\",\"recipientKeyHash\":\"/HUR35w58nctUQ==\",\"recipientTimestamp\":\"1762517652\"},\"deviceListMetadataVersion\":2}},\"pushName\":\"Joaozinho\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"audioMessage\",\"messageTimestamp\":1762806485},\"id\":\"2920925\",\"mediaPath\":\"3AE6DD602382807606A0.mpga\",\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":false,\"summary\":\"Usu√°rio enviou um √°udio com a seguinte transcri√ß√£o: `Eu sou corretor.`\\n\\n\",\"file\":{\"id\":\"248720\",\"companyId\":\"10\",\"moduleType\":\"Message\",\"moduleId\":\"2920925\",\"collection\":\"file\",\"bucket\":\"ticket/110928/\",\"name\":\"034412f8-0c08-4635-a3c6-88fc14e280b9.mp3\",\"fileName\":\"3AE6DD602382807606A0\",\"version\":null,\"extension\":\"mpga\",\"mimeType\":\"audio/mpeg\",\"size\":\"84680\",\"createdAt\":\"2025-11-10T17:28:07.313-03:00\",\"updatedAt\":\"2025-11-10T17:28:07.313-03:00\",\"meta\":{}},\"mediaUrl\":\"https://grqgzepwdxag.compat.objectstorage.sa-saopaulo-1.oraclecloud.com/files.apre.chat/000010/ticket/110928/3AE6DD602382807606A0.mpga\",\"meta\":{}},{\"body\":\"_dev-joaor_\\n*Alicia:*\\n√ìtimo, Jo√£o Vitor! üòÑ \\n\\nE hoje, o que mais tem te incomodado ou sentido falta na sua imobili√°ria? O que voc√™ gostaria de melhorar nos processos de loca√ß√£o, vendas ou atendimento?\",\"messageType\":\"conversation\",\"createdAt\":\"2025-11-10T17:28:17.000-03:00\",\"updatedAt\":\"2025-11-10T17:28:20.228-03:00\",\"dataJson\":{\"key\":{\"id\":\"3EB0AA60B24D9FFC64AB9F1E7DF72A468C1C9BDE\",\"fromMe\":true,\"remoteJid\":\"554788950332@s.whatsapp.net\"},\"source\":\"unknown\",\"status\":\"PENDING\",\"message\":{\"conversation\":\"_dev-joaor_\\n*Alicia:*\\n√ìtimo, Jo√£o Vitor! üòÑ \\n\\nE hoje, o que mais tem te incomodado ou sentido falta na sua imobili√°ria? O que voc√™ gostaria de melhorar nos processos de loca√ß√£o, vendas ou atendimento?\"},\"pushName\":\"Voc√™\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"conversation\",\"messageTimestamp\":1762806497},\"id\":\"2920926\",\"mediaPath\":null,\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":true,\"summary\":null,\"file\":null,\"mediaUrl\":null,\"meta\":{}},{\"body\":\"\",\"messageType\":\"audio\",\"createdAt\":\"2025-11-10T17:28:32.000-03:00\",\"updatedAt\":\"2025-11-10T17:28:42.952-03:00\",\"dataJson\":{\"key\":{\"id\":\"3ACFDD17529FF29D69A2\",\"fromMe\":false,\"remoteJid\":\"554788950332@s.whatsapp.net\",\"senderLid\":\"66237388329068@lid\"},\"source\":\"ios\",\"status\":\"DELIVERY_ACK\",\"message\":{\"audioMessage\":{\"ptt\":true,\"url\":\"https://mmg.whatsapp.net/v/t62.7117-24/581830541_715082104397506_4297213537276243913_n.enc?ccb=11-4&oh=01_Q5Aa3AG8x-xw3iSSsT_7MQKTZ06RYDKyAaOT6b2McDxI6cuQSA&oe=6939C118&_nc_sid=5e03e0&mms3=true\",\"seconds\":8,\"mediaKey\":\"+5h/TJOOCEiEMA5BuFGP7CkZf1aezDpIXDxCPt0r9CY=\",\"mimetype\":\"audio/ogg; codecs=opus\",\"waveform\":\"AQMCAgQGCAZWYGFkX1dkZGRkZGRkZEtbZGRkZGRkZGRkYl5kZGRkZGRkZGRfXmFkZGRkZGBfZGRkZEEkFQ0ICQ==\",\"directPath\":\"/v/t62.7117-24/581830541_715082104397506_4297213537276243913_n.enc?ccb=11-4&oh=01_Q5Aa3AG8x-xw3iSSsT_7MQKTZ06RYDKyAaOT6b2McDxI6cuQSA&oe=6939C118&_nc_sid=5e03e0\",\"fileLength\":\"18601\",\"fileSha256\":\"rJnfLme12ZDgWPnYcLJp4uT0fy0PGDPqMm1s8CGDtxg=\",\"fileEncSha256\":\"QhTXMc8sFIdbY2i0ANMvcKixbv3mlPARFFN39y3hsWg=\",\"streamingSidecar\":\"DdFIgVZRZXnlWg==\",\"mediaKeyTimestamp\":\"1762806502\"},\"messageContextInfo\":{\"messageSecret\":\"VP1MS/xYKfQA2pNKtTCpxybAWweavF0GWLjxKaH12m0=\",\"deviceListMetadata\":{\"senderKeyHash\":\"IJIgQVTRb/zQRg==\",\"senderTimestamp\":\"1762606390\",\"recipientKeyHash\":\"/HUR35w58nctUQ==\",\"recipientTimestamp\":\"1762517652\"},\"deviceListMetadataVersion\":2}},\"pushName\":\"Joaozinho\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"audioMessage\",\"messageTimestamp\":1762806512},\"id\":\"2920927\",\"mediaPath\":\"3ACFDD17529FF29D69A2.mpga\",\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":false,\"summary\":\"Usu√°rio enviou um √°udio com a seguinte transcri√ß√£o: `Ent√£o, o problema √© que hoje a gente tem que fazer a√≠ tudo pelo Excel e a gente t√° crescendo em imobili√°ria, ent√£o esse √© o maior problema.`\\n\\n\",\"file\":{\"id\":\"248721\",\"companyId\":\"10\",\"moduleType\":\"Message\",\"moduleId\":\"2920927\",\"collection\":\"file\",\"bucket\":\"ticket/110928/\",\"name\":\"8fe517f4-a651-462a-ba31-b7d75ef6d34f.mp3\",\"fileName\":\"3ACFDD17529FF29D69A2\",\"version\":null,\"extension\":\"mpga\",\"mimeType\":\"audio/mpeg\",\"size\":\"201291\",\"createdAt\":\"2025-11-10T17:28:35.058-03:00\",\"updatedAt\":\"2025-11-10T17:28:35.058-03:00\",\"meta\":{}},\"mediaUrl\":\"https://grqgzepwdxag.compat.objectstorage.sa-saopaulo-1.oraclecloud.com/files.apre.chat/000010/ticket/110928/3ACFDD17529FF29D69A2.mpga\",\"meta\":{}},{\"body\":\"_dev-joaor_\\n*Alicia:*\\nEntendi, Jo√£o Vitor! A falta de um sistema para facilitar a gest√£o √© realmente um desafio. \\n\\nE s√≥ pra eu entender melhor, quantas pessoas trabalham com voc√™ na imobili√°ria?\",\"messageType\":\"conversation\",\"createdAt\":\"2025-11-10T17:28:48.000-03:00\",\"updatedAt\":\"2025-11-10T17:28:50.863-03:00\",\"dataJson\":{\"key\":{\"id\":\"3EB00AB3122B1F7448DD869822B2528F59130DA4\",\"fromMe\":true,\"remoteJid\":\"554788950332@s.whatsapp.net\"},\"source\":\"unknown\",\"status\":\"PENDING\",\"message\":{\"conversation\":\"_dev-joaor_\\n*Alicia:*\\nEntendi, Jo√£o Vitor! A falta de um sistema para facilitar a gest√£o √© realmente um desafio. \\n\\nE s√≥ pra eu entender melhor, quantas pessoas trabalham com voc√™ na imobili√°ria?\"},\"pushName\":\"Voc√™\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"conversation\",\"messageTimestamp\":1762806528},\"id\":\"2920928\",\"mediaPath\":null,\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":true,\"summary\":null,\"file\":null,\"mediaUrl\":null,\"meta\":{}},{\"body\":\"\",\"messageType\":\"audio\",\"createdAt\":\"2025-11-10T17:29:55.000-03:00\",\"updatedAt\":\"2025-11-10T17:30:07.063-03:00\",\"dataJson\":{\"key\":{\"id\":\"3A0595AF861A638BB6D7\",\"fromMe\":false,\"remoteJid\":\"554788950332@s.whatsapp.net\",\"senderLid\":\"66237388329068@lid\"},\"source\":\"ios\",\"status\":\"DELIVERY_ACK\",\"message\":{\"audioMessage\":{\"ptt\":true,\"url\":\"https://mmg.whatsapp.net/v/t62.7117-24/582070630_4267132866893195_741820463479003194_n.enc?ccb=11-4&oh=01_Q5Aa3AF7dm7CpFQ2L-GwriJFxk61CipJIjjoUQKWIU6maciXgw&oe=6939B09B&_nc_sid=5e03e0&mms3=true\",\"seconds\":5,\"mediaKey\":\"Zk0nAfkjt6CWsYnuNa16ZTdIFk77c3kFHvxviifZZpc=\",\"mimetype\":\"audio/ogg; codecs=opus\",\"waveform\":\"AAEDAwQEBAUGBwgJNGRkYltUS0E2Ql1dVU5ISUtRWGBkZGRkZGRkZGRkZGRkZGRkZGRkZGNaTzgoHBgaFxIQDg==\",\"directPath\":\"/v/t62.7117-24/582070630_4267132866893195_741820463479003194_n.enc?ccb=11-4&oh=01_Q5Aa3AF7dm7CpFQ2L-GwriJFxk61CipJIjjoUQKWIU6maciXgw&oe=6939B09B&_nc_sid=5e03e0\",\"fileLength\":\"12401\",\"fileSha256\":\"yuBMLdIU1pGPwDCEDCx7xPgRlD5fSLdj3JEdRoxlVzA=\",\"fileEncSha256\":\"pXhmS8pCQEPomibdQn9RFErXPQhavx0V/20L5ek2c94=\",\"streamingSidecar\":\"QCv1LiDWohjYuA==\",\"mediaKeyTimestamp\":\"1762806594\"},\"messageContextInfo\":{\"messageSecret\":\"7R5nD5CemE7KmqbYHaxDP+4z9l/6VlrZk8R1DyuRgmw=\",\"deviceListMetadata\":{\"senderKeyHash\":\"IJIgQVTRb/zQRg==\",\"senderTimestamp\":\"1762606390\",\"recipientKeyHash\":\"/HUR35w58nctUQ==\",\"recipientTimestamp\":\"1762517652\"},\"deviceListMetadataVersion\":2}},\"pushName\":\"Joaozinho\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"audioMessage\",\"messageTimestamp\":1762806595},\"id\":\"2920929\",\"mediaPath\":\"3A0595AF861A638BB6D7.mpga\",\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":false,\"summary\":\"Usu√°rio enviou um √°udio com a seguinte transcri√ß√£o: `Hoje a gente t√° com quinze pessoas aqui, mas duas j√° est√£o de sa√≠da.`\\n\\n\",\"file\":{\"id\":\"248722\",\"companyId\":\"10\",\"moduleType\":\"Message\",\"moduleId\":\"2920929\",\"collection\":\"file\",\"bucket\":\"ticket/110928/\",\"name\":\"0fe09ddd-b0d8-4fb2-a2a8-5ef6d651d831.mp3\",\"fileName\":\"3A0595AF861A638BB6D7\",\"version\":null,\"extension\":\"mpga\",\"mimeType\":\"audio/mpeg\",\"size\":\"127939\",\"createdAt\":\"2025-11-10T17:29:59.044-03:00\",\"updatedAt\":\"2025-11-10T17:29:59.044-03:00\",\"meta\":{}},\"mediaUrl\":\"https://grqgzepwdxag.compat.objectstorage.sa-saopaulo-1.oraclecloud.com/files.apre.chat/000010/ticket/110928/3A0595AF861A638BB6D7.mpga\",\"meta\":{}},{\"body\":\"_dev-joaor_\\n*Alicia:*\\nObrigado pela informa√ß√£o, Jo√£o Vitor! üëç \\n\\nHoje voc√™s fazem gest√£o de contratos de loca√ß√£o? Se sim, quantos contratos voc√™s t√™m ativos?\",\"messageType\":\"conversation\",\"createdAt\":\"2025-11-10T17:30:13.000-03:00\",\"updatedAt\":\"2025-11-10T17:30:15.721-03:00\",\"dataJson\":{\"key\":{\"id\":\"3EB0767DA97DF960A43C6A61C176CB3F29166FF7\",\"fromMe\":true,\"remoteJid\":\"554788950332@s.whatsapp.net\"},\"source\":\"unknown\",\"status\":\"PENDING\",\"message\":{\"conversation\":\"_dev-joaor_\\n*Alicia:*\\nObrigado pela informa√ß√£o, Jo√£o Vitor! üëç \\n\\nHoje voc√™s fazem gest√£o de contratos de loca√ß√£o? Se sim, quantos contratos voc√™s t√™m ativos?\"},\"pushName\":\"Voc√™\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"conversation\",\"messageTimestamp\":1762806613},\"id\":\"2920930\",\"mediaPath\":null,\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":true,\"summary\":null,\"file\":null,\"mediaUrl\":null,\"meta\":{}},{\"body\":\"\",\"messageType\":\"audio\",\"createdAt\":\"2025-11-10T17:44:32.000-03:00\",\"updatedAt\":\"2025-11-10T17:44:45.962-03:00\",\"dataJson\":{\"key\":{\"id\":\"3AFB3133802DDFBFF598\",\"fromMe\":false,\"remoteJid\":\"554788950332@s.whatsapp.net\",\"senderLid\":\"66237388329068@lid\"},\"source\":\"ios\",\"status\":\"DELIVERY_ACK\",\"message\":{\"audioMessage\":{\"ptt\":true,\"url\":\"https://mmg.whatsapp.net/v/t62.7117-24/582058057_1339660413989150_3185259552210668542_n.enc?ccb=11-4&oh=01_Q5Aa3AHirLtTDdtsa-XPVUQUjREje-0YExt-GdQrCBRhV4qM8Q&oe=6939A6BF&_nc_sid=5e03e0&mms3=true\",\"seconds\":5,\"mediaKey\":\"wcNVpRzjOMUT5LxjtdsnROeMM0CqamDDTfAeW23IyOs=\",\"mimetype\":\"audio/ogg; codecs=opus\",\"waveform\":\"AAABAwMDBQgREw8LCAcbUmRkYFdCRFdNRFhkZGRkZGRkZGRkZGRkZGRkZF1OVWRkZGRdUltgUUExIxURFSQiGg==\",\"directPath\":\"/v/t62.7117-24/582058057_1339660413989150_3185259552210668542_n.enc?ccb=11-4&oh=01_Q5Aa3AHirLtTDdtsa-XPVUQUjREje-0YExt-GdQrCBRhV4qM8Q&oe=6939A6BF&_nc_sid=5e03e0\",\"fileLength\":\"13285\",\"fileSha256\":\"FkP9LcZ8leRDQwzZpuC+4EHD4ywamJctTL1Fw/5ieKA=\",\"fileEncSha256\":\"ruxba3Rr+JKtCsN/3Lzc4d+mFxCFMjmz/Pq6mZLZjIU=\",\"streamingSidecar\":\"B50hQWEt99H10A==\",\"mediaKeyTimestamp\":\"1762807465\"},\"messageContextInfo\":{\"messageSecret\":\"If8rKbHtxpGoBkUS/tP39z6Dj3akHuT+WZmqbgb4Jy8=\",\"deviceListMetadata\":{\"senderKeyHash\":\"IJIgQVTRb/zQRg==\",\"senderTimestamp\":\"1762606390\",\"recipientKeyHash\":\"/HUR35w58nctUQ==\",\"recipientTimestamp\":\"1762517652\"},\"deviceListMetadataVersion\":2}},\"pushName\":\"Joaozinho\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"audioMessage\",\"messageTimestamp\":1762807472},\"id\":\"2920931\",\"mediaPath\":\"3AFB3133802DDFBFF598.mpga\",\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":false,\"summary\":\"Usu√°rio enviou um √°udio com a seguinte transcri√ß√£o: `Hoje s√£o cerca de 385 contratos ativos.`\\n\\n\",\"file\":{\"id\":\"248723\",\"companyId\":\"10\",\"moduleType\":\"Message\",\"moduleId\":\"2920931\",\"collection\":\"file\",\"bucket\":\"ticket/110928/\",\"name\":\"dec66464-87b2-4bb5-8763-57b695a99a47.mp3\",\"fileName\":\"3AFB3133802DDFBFF598\",\"version\":null,\"extension\":\"mpga\",\"mimeType\":\"audio/mpeg\",\"size\":\"138597\",\"createdAt\":\"2025-11-10T17:44:36.833-03:00\",\"updatedAt\":\"2025-11-10T17:44:36.833-03:00\",\"meta\":{}},\"mediaUrl\":\"https://grqgzepwdxag.compat.objectstorage.sa-saopaulo-1.oraclecloud.com/files.apre.chat/000010/ticket/110928/3AFB3133802DDFBFF598.mpga\",\"meta\":{}},{\"body\":\"_dev-joaor_\\n*Alicia:*\\n√ìtimo, Jo√£o Vitor! üòÑ \\n\\nAgora, quantos im√≥veis voc√™ tem dispon√≠veis para neg√≥cio (para venda e loca√ß√£o), sem considerar os locados ou vendidos?\",\"messageType\":\"conversation\",\"createdAt\":\"2025-11-10T17:44:52.000-03:00\",\"updatedAt\":\"2025-11-10T17:44:55.628-03:00\",\"dataJson\":{\"key\":{\"id\":\"3EB052DC2C805443118A62E485700508A343AE07\",\"fromMe\":true,\"remoteJid\":\"554788950332@s.whatsapp.net\"},\"source\":\"unknown\",\"status\":\"PENDING\",\"message\":{\"conversation\":\"_dev-joaor_\\n*Alicia:*\\n√ìtimo, Jo√£o Vitor! üòÑ \\n\\nAgora, quantos im√≥veis voc√™ tem dispon√≠veis para neg√≥cio (para venda e loca√ß√£o), sem considerar os locados ou vendidos?\"},\"pushName\":\"Voc√™\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"conversation\",\"messageTimestamp\":1762807492},\"id\":\"2920932\",\"mediaPath\":null,\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":true,\"summary\":null,\"file\":null,\"mediaUrl\":null,\"meta\":{}},{\"body\":\"\",\"messageType\":\"audio\",\"createdAt\":\"2025-11-10T17:46:53.000-03:00\",\"updatedAt\":\"2025-11-10T17:47:05.247-03:00\",\"dataJson\":{\"key\":{\"id\":\"3AB6DC9BA306CA1B62C0\",\"fromMe\":false,\"remoteJid\":\"554788950332@s.whatsapp.net\",\"senderLid\":\"66237388329068@lid\"},\"source\":\"ios\",\"status\":\"DELIVERY_ACK\",\"message\":{\"audioMessage\":{\"ptt\":true,\"url\":\"https://mmg.whatsapp.net/v/t62.7117-24/31097311_866958142650225_3296865490397145898_n.enc?ccb=11-4&oh=01_Q5Aa3AEn4QCbi5JDFaJ_2oVSTlMx-RaIIgJjmjuLwBHkQJY_aw&oe=6939AD64&_nc_sid=5e03e0&mms3=true\",\"seconds\":5,\"mediaKey\":\"1cy7ld/L7cYQ8i5g4D7dnwKDc7KXl3q1Qnqfq9GzyeM=\",\"mimetype\":\"audio/ogg; codecs=opus\",\"waveform\":\"AAEDBAQEBAQJEA4NDRo8RkBETEdHWWRkXVFGPE1YR0FOU1RbZGRkZGRkWkpTZGRkZGRkZGRkZE88MSYZEQsKCw==\",\"directPath\":\"/v/t62.7117-24/31097311_866958142650225_3296865490397145898_n.enc?ccb=11-4&oh=01_Q5Aa3AEn4QCbi5JDFaJ_2oVSTlMx-RaIIgJjmjuLwBHkQJY_aw&oe=6939AD64&_nc_sid=5e03e0\",\"fileLength\":\"12652\",\"fileSha256\":\"DfUMdKaTYnvbthPEcEWq70Mff98dN88x9u58rUKGc4E=\",\"fileEncSha256\":\"3QVi1xXw/iiJXmkx/5+RJT3EMJa8knJkS5Q8cyNMRK8=\",\"streamingSidecar\":\"u2yIVNsJ9ky0LQ==\",\"mediaKeyTimestamp\":\"1762807611\"},\"messageContextInfo\":{\"messageSecret\":\"34HuCM1bDb8mpxaZc2dq5+MBj+6yHdPajxB5E8rRcpQ=\",\"deviceListMetadata\":{\"senderKeyHash\":\"IJIgQVTRb/zQRg==\",\"senderTimestamp\":\"1762606390\",\"recipientKeyHash\":\"/HUR35w58nctUQ==\",\"recipientTimestamp\":\"1762517652\"},\"deviceListMetadataVersion\":2}},\"pushName\":\"Joaozinho\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"audioMessage\",\"messageTimestamp\":1762807613},\"id\":\"2920933\",\"mediaPath\":\"3AB6DC9BA306CA1B62C0.mpga\",\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":false,\"summary\":\"Usu√°rio enviou um √°udio com a seguinte transcri√ß√£o: `Fala Neni, hoje s√£o cerca de dois mil im√≥veis.`\\n\\n\",\"file\":{\"id\":\"248724\",\"companyId\":\"10\",\"moduleType\":\"Message\",\"moduleId\":\"2920933\",\"collection\":\"file\",\"bucket\":\"ticket/110928/\",\"name\":\"9d0957d4-fa3e-4cba-82e3-f278998a12e3.mp3\",\"fileName\":\"3AB6DC9BA306CA1B62C0\",\"version\":null,\"extension\":\"mpga\",\"mimeType\":\"audio/mpeg\",\"size\":\"130447\",\"createdAt\":\"2025-11-10T17:46:56.992-03:00\",\"updatedAt\":\"2025-11-10T17:46:56.992-03:00\",\"meta\":{}},\"mediaUrl\":\"https://grqgzepwdxag.compat.objectstorage.sa-saopaulo-1.oraclecloud.com/files.apre.chat/000010/ticket/110928/3AB6DC9BA306CA1B62C0.mpga\",\"meta\":{}},{\"body\":\"_dev-joaor_\\n*Alicia:*\\nPerfeito, Jo√£o Vitor! üòÑ \\n\\nVoc√™ usa algum sistema hoje para gerenciar sua imobili√°ria? Se sim, qual deles?\",\"messageType\":\"conversation\",\"createdAt\":\"2025-11-10T17:47:12.000-03:00\",\"updatedAt\":\"2025-11-10T17:47:15.072-03:00\",\"dataJson\":{\"key\":{\"id\":\"3EB051DE022F3A4D1013358F6508E5CD120B5BB1\",\"fromMe\":true,\"remoteJid\":\"554788950332@s.whatsapp.net\"},\"source\":\"unknown\",\"status\":\"PENDING\",\"message\":{\"conversation\":\"_dev-joaor_\\n*Alicia:*\\nPerfeito, Jo√£o Vitor! üòÑ \\n\\nVoc√™ usa algum sistema hoje para gerenciar sua imobili√°ria? Se sim, qual deles?\"},\"pushName\":\"Voc√™\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"conversation\",\"messageTimestamp\":1762807632},\"id\":\"2920934\",\"mediaPath\":null,\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":true,\"summary\":null,\"file\":null,\"mediaUrl\":null,\"meta\":{}},{\"body\":\"\",\"messageType\":\"audio\",\"createdAt\":\"2025-11-10T17:48:02.000-03:00\",\"updatedAt\":\"2025-11-10T17:52:34.976-03:00\",\"dataJson\":{\"key\":{\"id\":\"3A514BA034DF8BD462F5\",\"fromMe\":false,\"remoteJid\":\"554788950332@s.whatsapp.net\",\"senderLid\":\"66237388329068@lid\"},\"source\":\"ios\",\"status\":\"DELIVERY_ACK\",\"message\":{\"audioMessage\":{\"ptt\":true,\"url\":\"https://mmg.whatsapp.net/v/t62.7117-24/580126488_3222451731268764_1613049829172827817_n.enc?ccb=11-4&oh=01_Q5Aa3AH0o-JUWJNLZeWaUK3GL_Vsed6SxCWOjGFY3e6tfFCuAg&oe=6939AB65&_nc_sid=5e03e0&mms3=true\",\"seconds\":6,\"mediaKey\":\"q3gQus9oxGeG0/kwLnGCVGYflLtK60Z3OyeKKlwcSck=\",\"mimetype\":\"audio/ogg; codecs=opus\",\"waveform\":\"AAIDAgIGDQoKCQYPHjNES0JFSUlaZGRkZGJPVGRkZGRkZGRkZGFZX2RkWFhkZFtPXmRkZGFaRzMhFxEMCA4RDw==\",\"directPath\":\"/v/t62.7117-24/580126488_3222451731268764_1613049829172827817_n.enc?ccb=11-4&oh=01_Q5Aa3AH0o-JUWJNLZeWaUK3GL_Vsed6SxCWOjGFY3e6tfFCuAg&oe=6939AB65&_nc_sid=5e03e0\",\"fileLength\":\"15509\",\"fileSha256\":\"2zCbCtizqwEXlZ1wwSdzBMFFlRtKzIrWRzWOuNnw8fw=\",\"fileEncSha256\":\"X2fkaFdjKWC/fFYfnpERVZLTx2cyk3kvColnsTH5pnE=\",\"streamingSidecar\":\"O2mM8QyAODLZiA==\",\"mediaKeyTimestamp\":\"1762807673\"},\"messageContextInfo\":{\"messageSecret\":\"kFu2wckBTUG4JP49WnXVRIjTOZ1VgrFxnwHI8IY4Qik=\",\"deviceListMetadata\":{\"senderKeyHash\":\"IJIgQVTRb/zQRg==\",\"senderTimestamp\":\"1762606390\",\"recipientKeyHash\":\"/HUR35w58nctUQ==\",\"recipientTimestamp\":\"1762517652\"},\"deviceListMetadataVersion\":2}},\"pushName\":\"Joaozinho\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"audioMessage\",\"messageTimestamp\":1762807682},\"id\":\"2920936\",\"mediaPath\":\"3A514BA034DF8BD462F5.mpga\",\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":false,\"summary\":\"Usu√°rio enviou um √°udio com a seguinte transcri√ß√£o: `Sim, sim, eu j√° uso o sistema da Vista, Vista Im√≥veis o nome.`\\n\\n\",\"file\":{\"id\":\"248725\",\"companyId\":\"10\",\"moduleType\":\"Message\",\"moduleId\":\"2920936\",\"collection\":\"file\",\"bucket\":\"ticket/110928/\",\"name\":\"0cb6f055-893e-4b30-8353-eb73476dc53e.mp3\",\"fileName\":\"3A514BA034DF8BD462F5\",\"version\":null,\"extension\":\"mpga\",\"mimeType\":\"audio/mpeg\",\"size\":\"161794\",\"createdAt\":\"2025-11-10T17:48:05.714-03:00\",\"updatedAt\":\"2025-11-10T17:51:43.092-03:00\",\"meta\":{}},\"mediaUrl\":\"https://grqgzepwdxag.compat.objectstorage.sa-saopaulo-1.oraclecloud.com/files.apre.chat/000010/ticket/110928/3A514BA034DF8BD462F5.mpga\",\"meta\":{}},{\"body\":\"\",\"messageType\":\"audio\",\"createdAt\":\"2025-11-10T17:51:54.000-03:00\",\"updatedAt\":\"2025-11-10T17:52:28.524-03:00\",\"dataJson\":{\"key\":{\"id\":\"3AA89032C5332003EED3\",\"fromMe\":false,\"remoteJid\":\"554788950332@s.whatsapp.net\",\"senderLid\":\"66237388329068@lid\"},\"source\":\"ios\",\"status\":\"DELIVERY_ACK\",\"message\":{\"audioMessage\":{\"ptt\":true,\"url\":\"https://mmg.whatsapp.net/v/t62.7117-24/540640751_1179980753466081_5659633715651840722_n.enc?ccb=11-4&oh=01_Q5Aa3AEFT3ZmB8Q4ZMeuhfnyAe0EDg9zmfO7waSS9oiscCIVxw&oe=6939DB1F&_nc_sid=5e03e0&mms3=true\",\"seconds\":5,\"mediaKey\":\"BVmIaE/+4f+LhG/Fxw8+1Zo9ecpsv0V54KC4BJcq0KQ=\",\"mimetype\":\"audio/ogg; codecs=opus\",\"waveform\":\"AAECAgIFCAgJCR5OXE5SYGRkZGRkZGRiVk1VXGFkZGRkYV1OOUZfZGRSQENGPjhASVlgWFRWUENDST4tIBUQCw==\",\"directPath\":\"/v/t62.7117-24/540640751_1179980753466081_5659633715651840722_n.enc?ccb=11-4&oh=01_Q5Aa3AEFT3ZmB8Q4ZMeuhfnyAe0EDg9zmfO7waSS9oiscCIVxw&oe=6939DB1F&_nc_sid=5e03e0\",\"fileLength\":\"11898\",\"fileSha256\":\"4ZRE5W99bQpKucS48gHPGkDI5lgdE8z9SO7S5hz8Zv4=\",\"fileEncSha256\":\"1HXW9pwJKcs/QgFKQR7wKjTBCUwWnYjCawIhBzuwsGM=\",\"streamingSidecar\":\"R9uDiZohm6GTUQ==\",\"mediaKeyTimestamp\":\"1762807907\"},\"messageContextInfo\":{\"messageSecret\":\"ZGl80yJA0o+/kyxH0POMUprQ4QadtQZBYdCsJEID84M=\",\"deviceListMetadata\":{\"senderKeyHash\":\"IJIgQVTRb/zQRg==\",\"senderTimestamp\":\"1762606390\",\"recipientKeyHash\":\"/HUR35w58nctUQ==\",\"recipientTimestamp\":\"1762517652\"},\"deviceListMetadataVersion\":2}},\"pushName\":\"Joaozinho\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"audioMessage\",\"messageTimestamp\":1762807914},\"id\":\"2920937\",\"mediaPath\":\"3AA89032C5332003EED3.mpga\",\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":false,\"summary\":\"Usu√°rio enviou um √°udio com a seguinte transcri√ß√£o: `N√£o, ent√£o, hoje eu uso o sistema ali da vista, s√≥ que eles n√£o t√£o atendendo muito bem.`\\n\\n\",\"file\":{\"id\":\"248726\",\"companyId\":\"10\",\"moduleType\":\"Message\",\"moduleId\":\"2920937\",\"collection\":\"file\",\"bucket\":\"ticket/110928/\",\"name\":\"4e10f433-8911-4806-8de5-e2531667e327.mp3\",\"fileName\":\"3AA89032C5332003EED3\",\"version\":null,\"extension\":\"mpga\",\"mimeType\":\"audio/mpeg\",\"size\":\"123551\",\"createdAt\":\"2025-11-10T17:51:56.798-03:00\",\"updatedAt\":\"2025-11-10T17:51:56.798-03:00\",\"meta\":{}},\"mediaUrl\":\"https://grqgzepwdxag.compat.objectstorage.sa-saopaulo-1.oraclecloud.com/files.apre.chat/000010/ticket/110928/3AA89032C5332003EED3.mpga\",\"meta\":{}},{\"body\":\"\",\"messageType\":\"audio\",\"createdAt\":\"2025-11-10T17:53:22.000-03:00\",\"updatedAt\":\"2025-11-10T17:57:02.108-03:00\",\"dataJson\":{\"key\":{\"id\":\"3A4D23A8C117B3420FF5\",\"fromMe\":false,\"remoteJid\":\"554788950332@s.whatsapp.net\",\"senderLid\":\"66237388329068@lid\"},\"source\":\"ios\",\"status\":\"DELIVERY_ACK\",\"message\":{\"audioMessage\":{\"ptt\":true,\"url\":\"https://mmg.whatsapp.net/v/t62.7117-24/539572129_1565131174841695_2536216855461398343_n.enc?ccb=11-4&oh=01_Q5Aa3AGdoiczH33kKooFUvKuckE2MqQbK3SVfx2b7Xa1hXwYLA&oe=6939BB15&_nc_sid=5e03e0&mms3=true\",\"seconds\":10,\"mediaKey\":\"VzqqeHNqyadpL4SOgbGCSEt7j9dm84cfXlcNmKa9o3o=\",\"mimetype\":\"audio/ogg; codecs=opus\",\"waveform\":\"AQQIBQUEKmRkZF5gV2RbY2RkZGA8WzJkWFdkS2Q4ZFlkZGRkUjEcFRAcGRRfZGRkZGRkZGRkZGRkZGRkZGAtGg==\",\"directPath\":\"/v/t62.7117-24/539572129_1565131174841695_2536216855461398343_n.enc?ccb=11-4&oh=01_Q5Aa3AGdoiczH33kKooFUvKuckE2MqQbK3SVfx2b7Xa1hXwYLA&oe=6939BB15&_nc_sid=5e03e0\",\"fileLength\":\"24815\",\"fileSha256\":\"x8OjYEgYkV5gV1ribtE7TWU1Qx7+dxOVaVeyzmZYlB4=\",\"fileEncSha256\":\"cKns6DlnQs68g0eaiWpqHoelZl7NmCqm1Ot4Pl/dOD0=\",\"streamingSidecar\":\"uOsx9kjuTgDBUA==\",\"mediaKeyTimestamp\":\"1762807990\"},\"messageContextInfo\":{\"messageSecret\":\"LcPL+tRCoz+6TqVby7IpCGxf70sP7XLVe81x9VI2mh8=\",\"deviceListMetadata\":{\"senderKeyHash\":\"IJIgQVTRb/zQRg==\",\"senderTimestamp\":\"1762606390\",\"recipientKeyHash\":\"/HUR35w58nctUQ==\",\"recipientTimestamp\":\"1762517652\"},\"deviceListMetadataVersion\":2}},\"pushName\":\"Joaozinho\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"audioMessage\",\"messageTimestamp\":1762808002},\"id\":\"2920938\",\"mediaPath\":\"3A4D23A8C117B3420FF5.mpga\",\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":false,\"summary\":\"Usu√°rio enviou um √°udio com a seguinte transcri√ß√£o: `N√£o, ent√£o, hoje a gente t√° fazendo tudo manualmente pelo Pix, n√©? Eu j√° vi a√≠ que o sistema de voc√™s d√° pra fazer tudo autom√°tico, diretamente?`\\n\\n\",\"file\":{\"id\":\"248727\",\"companyId\":\"10\",\"moduleType\":\"Message\",\"moduleId\":\"2920938\",\"collection\":\"file\",\"bucket\":\"ticket/110928/\",\"name\":\"51985d8f-566e-4663-ab4e-217b9c8cada1.mp3\",\"fileName\":\"3A4D23A8C117B3420FF5\",\"version\":null,\"extension\":\"mpga\",\"mimeType\":\"audio/mpeg\",\"size\":\"255208\",\"createdAt\":\"2025-11-10T17:53:25.383-03:00\",\"updatedAt\":\"2025-11-10T17:53:25.383-03:00\",\"meta\":{}},\"mediaUrl\":\"https://grqgzepwdxag.compat.objectstorage.sa-saopaulo-1.oraclecloud.com/files.apre.chat/000010/ticket/110928/3A4D23A8C117B3420FF5.mpga\",\"meta\":{}},{\"body\":\"\",\"messageType\":\"audio\",\"createdAt\":\"2025-11-10T17:56:47.000-03:00\",\"updatedAt\":\"2025-11-10T17:56:58.191-03:00\",\"dataJson\":{\"key\":{\"id\":\"3A4AF08E66C3A932FC86\",\"fromMe\":false,\"remoteJid\":\"554788950332@s.whatsapp.net\",\"senderLid\":\"66237388329068@lid\"},\"source\":\"ios\",\"status\":\"DELIVERY_ACK\",\"message\":{\"audioMessage\":{\"ptt\":true,\"url\":\"https://mmg.whatsapp.net/v/t62.7117-24/31813658_4230427777232900_2891058766866679164_n.enc?ccb=11-4&oh=01_Q5Aa3AEmtWaMc5LFXBnNcEVjls-LZsy8hNWE9ULxKWL8WAa1Yg&oe=6939D799&_nc_sid=5e03e0&mms3=true\",\"seconds\":7,\"mediaKey\":\"rj5yUJgHIJY9w2RNaJvKQ9gq+vEGXJ+lI5G4hE1Hv2s=\",\"mimetype\":\"audio/ogg; codecs=opus\",\"waveform\":\"AAEFBwUKFRsXGxcyZGRkZGRkWFtkZGRkWD5cZGRkZFtbZGRkZGRkZGFgZGRkZGRkZGRkZGRkXT0nFw0JEBAMCQ==\",\"directPath\":\"/v/t62.7117-24/31813658_4230427777232900_2891058766866679164_n.enc?ccb=11-4&oh=01_Q5Aa3AEmtWaMc5LFXBnNcEVjls-LZsy8hNWE9ULxKWL8WAa1Yg&oe=6939D799&_nc_sid=5e03e0\",\"fileLength\":\"16698\",\"fileSha256\":\"eZy3/0vBb2lQy8gf5XBdXCGgewA3676cwuynOXhQw+E=\",\"fileEncSha256\":\"ub7Tgsb3iqFc33UMbneTts9sz/ExcWNoV4tT+ZIhsu4=\",\"streamingSidecar\":\"istbTDU7qUxVmQ==\",\"mediaKeyTimestamp\":\"1762808206\"},\"messageContextInfo\":{\"messageSecret\":\"vR/KkViDHXKUapR0HmqGgRoIyCIuug1KiG1D6GVBGOw=\",\"deviceListMetadata\":{\"senderKeyHash\":\"IJIgQVTRb/zQRg==\",\"senderTimestamp\":\"1762606390\",\"recipientKeyHash\":\"/HUR35w58nctUQ==\",\"recipientTimestamp\":\"1762517652\"},\"deviceListMetadataVersion\":2}},\"pushName\":\"Joaozinho\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"audioMessage\",\"messageTimestamp\":1762808207},\"id\":\"2920939\",\"mediaPath\":\"3A4AF08E66C3A932FC86.mpga\",\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":false,\"summary\":\"Usu√°rio enviou um √°udio com a seguinte transcri√ß√£o: `N√£o, ent√£o, hoje a gente faz tudo no Pix aqui manualmente, at√© ver que o sistema de voc√™s d√° para fazer o repasse autom√°tico?`\\n\\n\",\"file\":{\"id\":\"248728\",\"companyId\":\"10\",\"moduleType\":\"Message\",\"moduleId\":\"2920939\",\"collection\":\"file\",\"bucket\":\"ticket/110928/\",\"name\":\"bcceb973-f6fd-4979-874b-a804167f4f8e.mp3\",\"fileName\":\"3A4AF08E66C3A932FC86\",\"version\":null,\"extension\":\"mpga\",\"mimeType\":\"audio/mpeg\",\"size\":\"177467\",\"createdAt\":\"2025-11-10T17:56:49.512-03:00\",\"updatedAt\":\"2025-11-10T17:56:49.512-03:00\",\"meta\":{}},\"mediaUrl\":\"https://grqgzepwdxag.compat.objectstorage.sa-saopaulo-1.oraclecloud.com/files.apre.chat/000010/ticket/110928/3A4AF08E66C3A932FC86.mpga\",\"meta\":{}},{\"body\":\"_dev-joaor_\\n*Alicia:*\\nSim, Jo√£o Vitor! O Apresenta.me possibilita o repasse autom√°tico dos valores, facilitando o processo. \\n\\nPara finalizar, quanto voc√™ estaria disposto a investir por m√™s em um sistema para sua imobili√°ria?\",\"messageType\":\"conversation\",\"createdAt\":\"2025-11-10T17:57:10.000-03:00\",\"updatedAt\":\"2025-11-10T17:57:13.094-03:00\",\"dataJson\":{\"key\":{\"id\":\"3EB0BE279C1ABB9A7B8EFC2A2A88F57FD424175F\",\"fromMe\":true,\"remoteJid\":\"554788950332@s.whatsapp.net\"},\"source\":\"unknown\",\"status\":\"PENDING\",\"message\":{\"conversation\":\"_dev-joaor_\\n*Alicia:*\\nSim, Jo√£o Vitor! O Apresenta.me possibilita o repasse autom√°tico dos valores, facilitando o processo. \\n\\nPara finalizar, quanto voc√™ estaria disposto a investir por m√™s em um sistema para sua imobili√°ria?\"},\"pushName\":\"Voc√™\",\"instanceId\":\"e31a1016-16d9-4452-a882-868b166fdcb2\",\"contextInfo\":null,\"messageType\":\"conversation\",\"messageTimestamp\":1762808230},\"id\":\"2920940\",\"mediaPath\":null,\"companyId\":\"10\",\"ticketId\":\"110928\",\"fromMe\":true,\"summary\":null,\"file\":null,\"mediaUrl\":null,\"meta\":{}}]","ticketId":110928},"webhookUrl":"https://n8n.apresenta.me/webhook/7223c6af-f595-4bc2-b84c-602b8900cd08","executionMode":"production"}}]},"versionId":"62d1401e-fe74-450a-a776-5a3fd4664108","triggerCount":1,"shared":[{"updatedAt":"2025-11-04T18:47:16.654Z","createdAt":"2025-11-04T18:47:16.654Z","role":"workflow:owner","workflowId":"dDaZdsSmHxktrhjc","projectId":"4ToGMYJEWvvDSbcz"}],"tags":[]}